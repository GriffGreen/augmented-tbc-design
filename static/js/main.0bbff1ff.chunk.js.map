{"version":3,"sources":["Header.tsx","PrettoSlider.tsx","InputParams.tsx","CurveDesignInputParams.tsx","SimulationInputParams.tsx","utils.ts","math.ts","SupplyVsDemandChart.tsx","ResultParams.tsx","PriceSimulationChart.tsx","HelpText.tsx","App.tsx","theme.tsx","index.tsx"],"names":["cadCadLink","useStyles","makeStyles","theme","createStyles","title","subtitle","color","palette","text","secondary","margin","spacing","subsubtitle","opacity","lightBulb","verticalAlign","marginRight","link","primary","main","logoContainer","display","alignItems","justifyContent","marginBottom","logo","width","logoText","fontSize","fontWeight","Header","classes","react_default","a","createElement","Fragment","className","src","alt","Typography","variant","Link","href","withStyles","root","height","thumb","backgroundColor","border","marginTop","marginLeft","&:focus,&:hover,&$active","boxShadow","active","valueLabel","left","track","borderRadius","rail","markLabel","top","Slider","leftContainer","centerContainer","listBoxContainer","& > div:not(:last-child)","paddingBottom","borderBottom","listBox","& > div","& p","paddingRight","slider","secondaryColor","light","NumberFormatCustom","props","inputRef","onChange","prefix","suffix","other","Object","objectWithoutProperties","number_format_default","assign","getInputRef","onValueChange","values","target","value","thousandSeparator","InputParams","_ref","inputFields","onChangeCommited","map","_ref2","label","setter","min","max","step","format","toText","toNum","sanitizeInput","num","arguments","length","undefined","isNaN","Grid","key","container","item","xs","id","gutterBottom","TextField","e","parseFloat","InputProps","inputComponent","disableUnderline","inputProps","PrettoSlider","concat","valueLabelDisplay","aria-label","defaultValue","_","newValue","Number","onChangeCommitted","valueLabelFormat","replace","CurveDesignInputParams","curveParams","setCurveParams","_useState","useState","_useState2","slicedToArray","theta","setTheta","_useState3","_useState4","p0","setP0","_useState5","_useState6","p1","setP1","_useState7","_useState8","wFee","setWFee","useEffect","maxReturnRate","n","Math","round","String","toFixed","newP0","params","objectSpread","d0","setD0","floor","linspace","_ref$from","from","to","steps","arr","x","push","getLinspaceTicks","data","desiredPoints","getLast","getAvg","reduce","t","c","abs","pause","ms","Promise","r","setTimeout","getInitialParams","k","R0","S0","V0","pow","getPriceR","R","getSlippage","_ref3","deltaR","S","realizedPrice","spotPrice","getDeltaR_priceGrowth","_ref4","priceGrowth","getTxDistribution","_ref5","sum","mean","off","i","randn_bm","rv_U","random","u","v","sqrt","log","cos","PI","keyHorizontal","keyVertical","tooltip","padding","SupplyVsDemandChart","_getInitialParams","R0_round","f","biggest","scaling","unit","_data$push","defineProperty","useTheme","formatter","toPrecision","toLocaleString","es6","debounce","right","bottom","strokeDasharray","interval","dataKey","tickFormatter","tick","fill","stroke","ticks","d","domain","content","payload","supply","reserve","price","toolTipData","_ref6","name","isAnimationActive","type","textAnchor","viewBox","y","style","ResultParams","resultFields","keyVerticalLeft","keyVerticalRight","PriceSimulationChart","priceTimeseries","withdrawFeeTimeseries","ReferenceLabel","toConsumableArray","yAxisId","apply","orientation","exit","weekNum","dark","fillOpacity","cursor","transition","&:hover","popoverContainer","paper","maxWidth","breakpoints","md","SimplePopover","_React$useState","React","_React$useState2","anchorEl","setAnchorEl","handleClose","open","Boolean","HelpOutline_default","onClick","currentTarget","Popover","PaperProps","onClose","anchorOrigin","vertical","horizontal","transformOrigin","Box","mainContainer","paddingTop","simulationContainer","minHeight","box","boxButton","boxHeader","boxBorderBottom","initialRaise","boxChart","maxHeight","paddingLeft","boxPlaceholder","header","textAlign","button","background","descriptionContainer","& td","descriptionTitle","typography","fontWeightBold","descriptionName","parameterDescriptions","resultParameterDescriptions","createMuiTheme","error","red","A400","default","h6","console","ReactDOM","render","ThemeProvider","CssBaseline","setCurveParamsThrottle","useMemo","throttle","setPriceTimeseries","setWithdrawFeeTimeseries","totalReserve","setTotalReserve","_useState9","_useState10","withdrawCount","setWithdrawCount","_useState11","_useState12","avgSlippage","setAvgSlippage","_useState13","_useState14","avgTxSize","setAvgTxSize","_useState15","_useState16","simulationActive","setSimulationActive","_useState17","_useState18","simulationRunning","setSimulationRunning","_startSimulation","asyncToGenerator","regenerator_default","mark","_callee2","wrap","_context2","prev","next","stop","this","canContinueSimulation","_simulateRandomDelta","_callee","R_t","p_t","wFee_t","slippage_t","avgTxSize_t","numSteps","_loop","_context","txsWeek","ceil","R_next","txs","slippage","txR","txsWithdraw","filter","tx","wFees","_avgTxSize","abrupt","simulateRandomDelta","Container","fixed","sm","lg","Paper","SimulationInputParams_CurveDesignInputParams","src_SupplyVsDemandChart","direction","justify","Button","disabled","src_PriceSimulationChart","document","querySelector"],"mappings":"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","file":"static/js/main.0bbff1ff.chunk.js","sourcesContent":["import React from \"react\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport Link from \"@material-ui/core/Link\";\nimport Typography from \"@material-ui/core/Typography\";\n\nconst cadCadLink =\n  \"https://medium.com/block-science/cadcad-filling-a-critical-gap-in-open-source-data-science-fcd0d3faa8ed\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    title: {\n      // color: theme.palette.text.secondary,\n    },\n    subtitle: {\n      color: theme.palette.text.secondary,\n      margin: theme.spacing(3, 0, 0)\n    },\n    subsubtitle: {\n      color: theme.palette.text.secondary,\n      opacity: 0.6\n    },\n    lightBulb: {\n      verticalAlign: \"middle\",\n      marginRight: theme.spacing(1)\n    },\n    link: {\n      color: theme.palette.primary.main\n    },\n    logoContainer: {\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      marginBottom: theme.spacing(4)\n    },\n    logo: {\n      width: \"25px\",\n      marginRight: \"4px\"\n    },\n    logoText: {\n      display: \"inline\",\n      fontSize: \"1.1rem\",\n      fontWeight: 500\n    }\n  })\n);\n\nexport default function Header() {\n  const classes = useStyles();\n  return (\n    <>\n      <div className={classes.logoContainer}>\n        <img src=\"./favicon.ico\" className={classes.logo} alt=\"logo\" />\n        <Typography className={classes.logoText}>Commons Stack</Typography>\n      </div>\n\n      <Typography className={classes.title} variant=\"h4\">\n        Augmented Token Bonding Curve Design\n      </Typography>\n\n      <Typography className={classes.subtitle}>\n        Experiment and test augmented token bonding curves\n      </Typography>\n      <Typography className={classes.subsubtitle}>\n        A narrative showcase of <Link href={cadCadLink}>cadCAD</Link>\n        's capabilities\n      </Typography>\n    </>\n  );\n}\n","import { withStyles } from \"@material-ui/core/styles\";\nimport Slider from \"@material-ui/core/Slider\";\n\nexport default withStyles({\n  root: {\n    height: 8\n  },\n  thumb: {\n    height: 24,\n    width: 24,\n    backgroundColor: \"#fff\",\n    border: \"2px solid currentColor\",\n    marginTop: -8,\n    marginLeft: -12,\n    \"&:focus,&:hover,&$active\": {\n      boxShadow: \"inherit\"\n    }\n  },\n  active: {},\n  valueLabel: {\n    left: \"calc(-50% + 4px)\"\n  },\n  track: {\n    height: 8,\n    borderRadius: 4\n  },\n  rail: {\n    height: 8,\n    borderRadius: 4\n  },\n  markLabel: {\n    top: 30\n  }\n})(Slider);\n","import React from \"react\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Grid from \"@material-ui/core/Grid\";\nimport TextField from \"@material-ui/core/TextField\";\nimport NumberFormat from \"react-number-format\";\nimport { InputFieldInterface } from \"./types\";\nimport PrettoSlider from \"./PrettoSlider\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      margin: theme.spacing(6, 0, 3)\n    },\n    lightBulb: {\n      verticalAlign: \"middle\",\n      marginRight: theme.spacing(1)\n    },\n    leftContainer: {\n      color: theme.palette.text.secondary\n    },\n    centerContainer: {\n      // color: blackColor\n    },\n    listBoxContainer: {\n      \"& > div:not(:last-child)\": {\n        paddingBottom: \"12px\",\n        marginBottom: \"12px\",\n        borderBottom: \"1px solid #313d47\"\n      }\n    },\n    listBox: {\n      \"& > div\": {\n        display: \"flex\",\n        alignItems: \"center\",\n        \"& p\": {\n          marginBottom: 0\n        }\n      },\n      \"& > div:not(:last-child)\": {\n        paddingRight: \"12px\"\n      }\n    },\n    slider: {\n      color: theme.palette.primary.main\n    },\n    secondaryColor: {\n      color: theme.palette.secondary.light\n    }\n  })\n);\n\nfunction NumberFormatCustom(props: any) {\n  const { inputRef, onChange, prefix, suffix, ...other } = props;\n\n  return (\n    <NumberFormat\n      {...other}\n      getInputRef={inputRef}\n      onValueChange={values => {\n        onChange({ target: { value: values.value } });\n      }}\n      thousandSeparator\n      prefix={prefix}\n      suffix={suffix}\n    />\n  );\n}\n\nexport default function InputParams({\n  inputFields,\n  onChangeCommited\n}: {\n  inputFields: InputFieldInterface[];\n  onChangeCommited(): void;\n}) {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.listBoxContainer}>\n      {inputFields.map(\n        ({\n          label,\n          value,\n          setter,\n          min,\n          max,\n          step,\n          prefix,\n          suffix,\n          secondaryColor,\n          format,\n          toText,\n          toNum\n        }) => {\n          function sanitizeInput(num: number = 0) {\n            if (isNaN(num)) num = 0;\n            if (num > max) num = max;\n            else if (num < min) num = min;\n            setter(num);\n          }\n\n          return (\n            <Grid key={label} container spacing={0} className={classes.listBox}>\n              <Grid item xs={6} className={classes.leftContainer}>\n                <Typography id={label} gutterBottom>\n                  {label}\n                </Typography>\n              </Grid>\n\n              <Grid item xs={2} className={classes.centerContainer}>\n                {/* <Typography gutterBottom>{display(value)}</Typography> */}\n                <TextField\n                  onChange={e => {\n                    sanitizeInput(\n                      toNum ? toNum(e.target.value) : parseFloat(e.target.value)\n                    );\n                    onChangeCommited();\n                  }}\n                  InputProps={{\n                    inputComponent: NumberFormatCustom,\n                    disableUnderline: true,\n                    inputProps: {\n                      prefix,\n                      suffix\n                    }\n                  }}\n                  value={toText ? toText(value) : value}\n                />\n              </Grid>\n\n              <Grid item xs={4}>\n                <PrettoSlider\n                  className={`${classes.slider} ${\n                    secondaryColor ? classes.secondaryColor : \"\"\n                  }`}\n                  valueLabelDisplay=\"auto\"\n                  aria-label={label}\n                  defaultValue={value}\n                  onChange={(_, newValue) => sanitizeInput(Number(newValue))}\n                  onChangeCommitted={onChangeCommited}\n                  value={value}\n                  min={min}\n                  max={max}\n                  step={step}\n                  valueLabelFormat={value => format(value).replace(\"$\", \"\")}\n                />\n              </Grid>\n            </Grid>\n          );\n        }\n      )}\n    </div>\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport { InputFieldInterface, CurveParamsInterface } from \"./types\";\nimport InputParams from \"./InputParams\";\n\nexport default function CurveDesignInputParams({\n  curveParams,\n  setCurveParams\n}: {\n  curveParams: CurveParamsInterface;\n  setCurveParams(newCurveParams: any): void;\n}) {\n  const [theta, setTheta] = useState(0.35); // fraction allocated to reserve (.)\n  const [p0, setP0] = useState(0.1); // Hatch sale Price p0 (DAI / token)\n  const [p1, setP1] = useState(0.3); // Return factor (.)\n  const [wFee, setWFee] = useState(0.05); // friction coefficient (.)\n\n  useEffect(() => {\n    setTheta(curveParams.theta);\n    setP0(curveParams.p0);\n    setP1(curveParams.p1);\n    setWFee(curveParams.wFee);\n  }, [curveParams]);\n\n  function _setP0(newP0: number) {\n    setP0(newP0);\n    if (p1 < newP0) setP1(newP0);\n    else if (p1 > newP0 * maxReturnRate) setP1(newP0 * maxReturnRate);\n  }\n\n  function setParentCurveParams() {\n    setCurveParams((params: CurveParamsInterface) => ({\n      ...params,\n      theta,\n      p0,\n      p1,\n      wFee\n    }));\n  }\n\n  const maxReturnRate = 10;\n\n  const inputFields: InputFieldInterface[] = [\n    {\n      label: \"Allocation to funding pool\",\n      value: theta,\n      setter: setTheta,\n      min: 0,\n      max: 0.9,\n      step: 0.01,\n      suffix: \"%\",\n      format: (n: number) => `${Math.round(100 * n)}%`,\n      toText: (n: number) => String(+(n * 1e2).toFixed(0)),\n      toNum: (n: string) => parseFloat(n) * 1e-2\n    },\n    {\n      label: \"Hatch price (DAI/token)\",\n      value: p0,\n      setter: _setP0,\n      min: 0.01,\n      max: 1,\n      step: 0.01,\n      toText: (n: number) => String(+n.toFixed(2)),\n      toNum: (n: string) => parseFloat(n),\n      format: (n: number) => `$${n}`\n    },\n    {\n      label: \"Post-hatch price (DAI/token)\",\n      value: p1,\n      setter: setP1,\n      min: p0 || 0.1,\n      max: Number((maxReturnRate * p0).toFixed(2)),\n      step: 0.01,\n      toText: (n: number) => String(+n.toFixed(2)),\n      toNum: (n: string) => parseFloat(n),\n      format: (n: number) => `$${n}`\n    },\n    {\n      label: \"Exit tribute\",\n      value: wFee,\n      setter: setWFee,\n      min: 0,\n      max: 0.1,\n      step: 0.001,\n      suffix: \"%\",\n      format: (n: number) => `${+(100 * n).toFixed(1)}%`,\n      toText: (n: number) => String(+(n * 1e2).toFixed(1)),\n      toNum: (n: string) => parseFloat(n) * 1e-2\n    }\n  ];\n\n  return (\n    <InputParams\n      inputFields={inputFields}\n      onChangeCommited={setParentCurveParams}\n    />\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport { InputFieldInterface, CurveParamsInterface } from \"./types\";\nimport InputParams from \"./InputParams\";\n\nexport default function CurveDesignInputParams({\n  curveParams,\n  setCurveParams\n}: {\n  curveParams: CurveParamsInterface;\n  setCurveParams(newCurveParams: any): void;\n}) {\n  const [d0, setD0] = useState(3e6); // Initial raise, d0 (DAI)\n\n  useEffect(() => {\n    setD0(curveParams.d0);\n  }, [curveParams]);\n\n  function setParentCurveParams() {\n    setCurveParams((params: CurveParamsInterface) => ({\n      ...params,\n      d0\n    }));\n  }\n\n  const inputFields: InputFieldInterface[] = [\n    {\n      label: \"Initial raise (DAI)\",\n      value: d0,\n      setter: setD0,\n      min: 0.1e6,\n      max: 10e6,\n      step: 0.1e6,\n      suffix: \"M\",\n      format: (n: number) => `$${+(n * 1e-6).toFixed(1)}M`,\n      toText: (n: number) => String(+(n * 1e-6).toFixed(1)),\n      toNum: (n: string) => Math.floor(parseFloat(n) * 1e6),\n      secondaryColor: true\n    }\n  ];\n\n  return (\n    <InputParams\n      inputFields={inputFields}\n      onChangeCommited={setParentCurveParams}\n    />\n  );\n}\n","/**\n * Returns an equally spaced array of numbers `from`, `to` with `steps`.\n */\nexport function linspace({\n  from = 0,\n  to,\n  steps\n}: {\n  from?: number;\n  to: number;\n  steps: number;\n}) {\n  const arr = [];\n  for (let x = from; x <= to; x += (to - from) / steps) arr.push(x);\n  return arr;\n}\n\n/**\n * Returns a uniform distribution of `num` ticks\n */\nexport function getLinspaceTicks(data: number[], num: number) {\n  const desiredPoints = [];\n  const step = (data[data.length - 1] - data[0]) / num;\n  for (let x = data[0]; x < data[data.length - 1]; x += step) {\n    desiredPoints.push(x);\n  }\n  if (desiredPoints.length < num + 1) desiredPoints.push(data[data.length - 1]);\n\n  return desiredPoints;\n}\n\n/**\n * Returns the last element of an array\n */\nexport function getLast(a: number[]) {\n  return a[a.length - 1];\n}\n\n/**\n * Returns the average of an array\n */\nexport function getAvg(a: number[]) {\n  return a.reduce((t, c) => t + Math.abs(c), 0) / a.length;\n}\n\n/**\n * Waits `ms` miliseconds and resolves\n */\nexport function pause(ms: number) {\n  return new Promise(r => setTimeout(r, ms));\n}\n","/**\n * Computes the initial params given the \"user friendly\" params:\n * - Initial raise, `d0` (DAI)\n * - fraction allocated to reserve, `theta`\n * - Hatch sale price, `p0` (DAI / token)\n * - Return factor, `returnF`\n */\nexport function getInitialParams({\n  d0,\n  theta,\n  p0,\n  p1\n}: {\n  d0: number;\n  theta: number;\n  p0: number;\n  p1: number;\n}) {\n  const k = p1 / p0 / (1 - theta); // Invariant power kappa (.)\n  const R0 = (1 - theta) * d0; // Initial reserve (DAI)\n  const S0 = d0 / p0; // initial supply of tokens (token)\n  const V0 = S0 ** k / R0; // invariant coef\n  return { k, R0, S0, V0 };\n}\n\n/**\n * Computes the price at a specific reserve `R`\n */\nexport function getPriceR({ R, V0, k }: { R: number; V0: number; k: number }) {\n  return (k * R ** ((k - 1) / k)) / V0 ** (1 / k);\n}\n\n/**\n * Compute slippage at a point `R`, given a `deltaR`\n */\nexport function getSlippage({\n  R,\n  deltaR,\n  V0,\n  k\n}: {\n  R: number;\n  deltaR: number;\n  V0: number;\n  k: number;\n}) {\n  const S = (V0 * R) ** (1 / k);\n  const deltaS = (V0 * (R + deltaR)) ** (1 / k) - S;\n  const realizedPrice = deltaR / deltaS;\n  const spotPrice = getPriceR({ R, V0, k });\n  return Math.abs(realizedPrice - spotPrice) / spotPrice;\n}\n\n// Price walk utils\n\n/**\n * Get deltaR for a given price growth factor\n */\nexport function getDeltaR_priceGrowth({\n  R,\n  k,\n  priceGrowth\n}: {\n  R: number;\n  k: number;\n  priceGrowth: number;\n}) {\n  return -R + (priceGrowth * R ** (1 - 1 / k)) ** (k / (-1 + k));\n}\n\n/**\n * Computes a tx distribution using a normal distribution,\n * Given a sum of tx value and a number of transactions\n *\n * Demo: https://codepen.io/anon/pen/mNqJjv?editors=0010#0\n * Very quick: < 10ms for 10000 txs\n */\nexport function getTxDistribution({ sum, num }: { sum: number; num: number }) {\n  const mean = sum / num;\n  const off = mean * 4;\n  const x: number[] = [];\n  for (let i = 0; i < num; i++) {\n    x[i] = randn_bm(mean - off, mean + off);\n  }\n  return x;\n}\n\n// Minor utils\n\n/**\n * Random variable uniformly distributed\n */\nexport function rv_U(min: number, max: number) {\n  return Math.random() * (max - min) + min;\n}\n\n/**\n * Standard Normal variate using Box-Muller transform.\n * by https://stackoverflow.com/questions/25582882/javascript-math-random-normal-distribution-gaussian-bell-curve/36481059#36481059\n */\nfunction randn_bm(min: number, max: number) {\n  var u = 0,\n    v = 0;\n  while (u === 0) u = Math.random(); //Converting [0,1) to (0,1)\n  while (v === 0) v = Math.random();\n  let num = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);\n\n  num = num / 10.0 + 0.5; // Translate to 0 -> 1\n  if (num > 1 || num < 0) num = randn_bm(min, max); // resample between 0 and 1 if out of range\n  num *= max - min; // Stretch to fill range\n  num += min; // offset to min\n  return num;\n}\n","import React from \"react\";\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Legend,\n  ReferenceLine,\n  ResponsiveContainer,\n  Tooltip\n} from \"recharts\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport { getLinspaceTicks } from \"./utils\";\nimport { getInitialParams, getPriceR } from \"./math\";\nimport { useTheme } from \"@material-ui/styles\";\n\nconst keyHorizontal = \"x\";\nconst keyVertical = \"Supply (tokens) / Reserve (DAI)\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    tooltip: {\n      border: \"1px solid #313d47\",\n      backgroundColor: \"#384b59\",\n      padding: theme.spacing(1),\n      color: \"#c7ccd2\"\n    }\n  })\n);\n\nfunction SupplyVsDemandChart({\n  theta,\n  d0,\n  p0,\n  p1\n}: {\n  theta: number;\n  d0: number;\n  p0: number;\n  p1: number;\n}) {\n  // d0      - Initial raise, d0 (DAI)\n  // theta   - fraction allocated to reserve (.)\n  // p0      - Hatch sale Price p0 (DAI / token)\n  // returnF - Return factor (.)\n  // wFee    - friction coefficient (.)\n\n  // Hatch parameters\n  const {\n    k, // Invariant power kappa (.)\n    R0, // Initial reserve (DAI)\n    S0, // initial supply of tokens (token)\n    V0 // invariant coef\n  } = getInitialParams({\n    d0,\n    theta,\n    p0,\n    p1\n  });\n  const R0_round = Math.round(R0);\n  const S_of_R = (R: number) => S0 * (R / R0_round) ** (1 / k);\n\n  // Function setup\n  const f = S_of_R;\n  const from = 0;\n  const to = 4 * R0_round;\n  const steps = 100 + 1; // Add 1 for the ticks to match\n  const step = Math.round((to - from) / (steps - 1));\n\n  /**\n   * Prettify the result converting 1000000 to 1M\n   */\n  const biggest = Math.max(to, f(to));\n  const [scaling, unit] =\n    // Billion\n    biggest > 0.5e9\n      ? [1e9, \"B\"]\n      : // Million\n      biggest > 0.5e6\n      ? [1e6, \"M\"]\n      : // 1 thousand\n      biggest > 0.5e3\n      ? [1e3, \"K\"]\n      : // No scale\n        [1, \"\"];\n\n  const data = [];\n  for (let i = 0; i < steps; i++) {\n    const x = Math.round(from + step * i);\n    data.push({\n      [keyHorizontal]: x,\n      [keyVertical]: f(x)\n    });\n  }\n\n  // Chart components\n\n  const theme: any = useTheme();\n  const classes = useStyles();\n\n  const formatter = (n: number) =>\n    (+(n / scaling).toPrecision(2)).toLocaleString();\n\n  function renderColorfulLegendText(value: string) {\n    return <span style={{ color: theme.palette.text.secondary }}>{value}</span>;\n  }\n\n  function ReferenceLabel(props: any) {\n    const { textAnchor, viewBox } = props;\n    return (\n      <text\n        x={viewBox.x + 10}\n        y={30}\n        fill={theme.palette.text.secondary}\n        textAnchor={textAnchor}\n      >\n        Initial value\n      </text>\n    );\n  }\n\n  function CustomTooltip({ active, payload, label }: any) {\n    if (active) {\n      const supply = payload[0].value;\n      const reserve = label;\n      const price = getPriceR({ R: reserve, V0, k });\n      const toolTipData: string[][] = [\n        [\"Supply\", formatter(supply) + unit, \"tokens\"],\n        [\"Reserve\", formatter(reserve) + unit, \"DAI\"],\n        [\"Price\", price.toFixed(2), \"DAI/token\"]\n      ];\n      return (\n        <div className={classes.tooltip}>\n          <table>\n            <tbody>\n              {toolTipData.map(([name, value, unit]) => (\n                <tr key={name}>\n                  <td>{name}</td>\n                  <td>{value}</td>\n                  <td>{unit}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      );\n    } else return null;\n  }\n\n  return (\n    <ResponsiveContainer debounce={1}>\n      <AreaChart\n        width={0}\n        height={400}\n        data={data}\n        margin={{\n          top: 10,\n          right: 30,\n          left: 0,\n          bottom: 0\n        }}\n      >\n        <CartesianGrid strokeDasharray=\"3 3\" />\n        <XAxis\n          interval={24}\n          dataKey={keyHorizontal}\n          tickFormatter={formatter}\n          unit={unit}\n          tick={{ fill: theme.palette.text.secondary }}\n          stroke={theme.palette.text.secondary}\n        />\n        <YAxis\n          interval={\"preserveStartEnd\"}\n          ticks={getLinspaceTicks(data.map(d => d[keyVertical]), 3)}\n          tickFormatter={formatter}\n          unit={unit}\n          tick={{ fill: theme.palette.text.secondary }}\n          domain={[0, f(to)]}\n          stroke={theme.palette.text.secondary}\n        />\n        <Tooltip content={<CustomTooltip />} />\n        <Area\n          isAnimationActive={false}\n          type=\"monotone\"\n          dataKey={keyVertical}\n          stroke={theme.palette.primary.main}\n          fill={theme.palette.primary.main}\n        />\n        <ReferenceLine\n          x={R0_round}\n          stroke={theme.palette.primary.main}\n          strokeDasharray=\"9 0\"\n          label={<ReferenceLabel />}\n        />\n        <Legend formatter={renderColorfulLegendText} />\n      </AreaChart>\n    </ResponsiveContainer>\n  );\n}\n\nexport default SupplyVsDemandChart;\n","import React from \"react\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Grid from \"@material-ui/core/Grid\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      margin: theme.spacing(6, 0, 3)\n    },\n    lightBulb: {\n      verticalAlign: \"middle\",\n      marginRight: theme.spacing(1)\n    },\n    leftContainer: {\n      color: theme.palette.text.secondary\n    },\n    centerContainer: {\n      // color: blackColor\n    },\n    listBoxContainer: {\n      \"& > div:not(:last-child)\": {\n        marginBottom: \"12px\",\n        borderBottom: \"1px solid #313d47\"\n      }\n    },\n    listBox: {\n      paddingBottom: \"12px\",\n      \"& > div\": {\n        display: \"flex\",\n        alignItems: \"center\",\n        \"& p\": {\n          marginBottom: 0\n        }\n      },\n      \"& > div:not(:last-child)\": {\n        paddingRight: \"12px\"\n      }\n    }\n  })\n);\n\nexport default function ResultParams({\n  resultFields\n}: {\n  resultFields: {\n    label: string;\n    value: number | string;\n  }[];\n}) {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.listBoxContainer}>\n      {resultFields.map(({ label, value }) => (\n        <Grid key={label} container spacing={0} className={classes.listBox}>\n          <Grid item xs={8} className={classes.leftContainer}>\n            <Typography id={label} gutterBottom>\n              {label}\n            </Typography>\n          </Grid>\n\n          <Grid item xs={4} className={classes.centerContainer}>\n            <Typography gutterBottom>{value}</Typography>\n          </Grid>\n        </Grid>\n      ))}\n    </div>\n  );\n}\n","import React from \"react\";\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Legend,\n  ReferenceLine,\n  ResponsiveContainer,\n  Tooltip\n} from \"recharts\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport { useTheme } from \"@material-ui/styles\";\nimport { linspace } from \"./utils\";\n\nconst keyHorizontal = \"x\";\nconst keyVerticalLeft = \"Price (DAI/token)\";\nconst keyVerticalRight = \"Total exit tributes (DAI)\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    tooltip: {\n      border: \"1px solid #313d47\",\n      backgroundColor: \"#384b59\",\n      padding: theme.spacing(1),\n      color: \"#c7ccd2\"\n    }\n  })\n);\n\nfunction PriceSimulationChart({\n  priceTimeseries,\n  withdrawFeeTimeseries,\n  p0,\n  p1\n}: {\n  priceTimeseries: number[];\n  withdrawFeeTimeseries: number[];\n  p0: number;\n  p1: number;\n}) {\n  // d0      - Initial raise, d0 (DAI)\n  // theta   - fraction allocated to reserve (.)\n  // p0      - Hatch sale Price p0 (DAI / token)\n  // returnF - Return factor (.)\n  // wFee    - friction coefficient (.)\n\n  const data = [];\n  for (let t = 0; t < priceTimeseries.length; t++) {\n    data.push({\n      [keyHorizontal]: t,\n      [keyVerticalLeft]: priceTimeseries[t] || 0,\n      [keyVerticalRight]: withdrawFeeTimeseries[t] || 0\n    });\n  }\n\n  // Chart components\n\n  const theme: any = useTheme();\n  const classes = useStyles();\n\n  function renderColorfulLegendText(value: string) {\n    return <span style={{ color: theme.palette.text.secondary }}>{value}</span>;\n  }\n\n  const formatter = (n: number) => (+n.toPrecision(3)).toLocaleString();\n\n  function ReferenceLabel(props: any) {\n    const { textAnchor, viewBox, text } = props;\n    return (\n      <text\n        x={viewBox.x + 10}\n        y={viewBox.y - 10}\n        fill={theme.palette.text.secondary}\n        textAnchor={textAnchor}\n      >\n        {text}\n      </text>\n    );\n  }\n\n  function CustomTooltip({ active, payload, label }: any) {\n    if (active) {\n      const price = payload[0].value;\n      const exit = payload[1].value;\n      const weekNum = label;\n      const toolTipData: string[][] = [\n        [\"Price\", price.toFixed(2), \"DAI/tk\"],\n        [\"Exit t.\", formatter(exit), \"DAI\"],\n        [\"Week\", weekNum, \"\"]\n      ];\n\n      return (\n        <div className={classes.tooltip}>\n          <table>\n            <tbody>\n              {toolTipData.map(([name, value, unit]) => (\n                <tr key={name}>\n                  <td>{name}</td>\n                  <td>{value}</td>\n                  <td>{unit}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      );\n    } else return null;\n  }\n\n  return (\n    <ResponsiveContainer debounce={1}>\n      <AreaChart\n        width={0}\n        height={400}\n        data={data}\n        margin={{\n          top: 10,\n          right: 30,\n          left: 0,\n          bottom: 0\n        }}\n      >\n        <CartesianGrid strokeDasharray=\"3 3\" />\n        <XAxis\n          dataKey={keyHorizontal}\n          tick={{ fill: theme.palette.text.secondary }}\n          stroke={theme.palette.text.secondary}\n          ticks={[\n            ...linspace({\n              to: priceTimeseries.length,\n              steps: 4\n            }).map(Math.floor),\n            priceTimeseries.length - 1\n          ]}\n        />\n\n        {/* Price time evolution */}\n        <YAxis\n          yAxisId=\"left\"\n          domain={[0, Math.max(...priceTimeseries, p1 * 1.25)]}\n          tickFormatter={formatter}\n          tick={{ fill: theme.palette.text.secondary }}\n          stroke={theme.palette.text.secondary}\n        />\n\n        {/* Capital collected from withdraw fees - AXIS */}\n        <YAxis\n          yAxisId=\"right\"\n          // domain={[\n          //   Math.floor(Math.min(...withdrawFeeTimeseries)),\n          //   Math.ceil(Math.max(...withdrawFeeTimeseries))\n          // ]}\n          orientation=\"right\"\n          tick={{ fill: theme.palette.text.secondary }}\n          stroke={theme.palette.text.secondary}\n        />\n\n        <Tooltip content={<CustomTooltip />} />\n\n        <Area\n          isAnimationActive={false}\n          yAxisId=\"left\"\n          type=\"monotone\"\n          dataKey={keyVerticalLeft}\n          stroke={theme.palette.primary.main}\n          fill={theme.palette.primary.main}\n        />\n        <ReferenceLine\n          y={p0}\n          yAxisId=\"left\"\n          stroke={theme.palette.primary.main}\n          strokeDasharray=\"9 0\"\n          label={<ReferenceLabel text=\"Hatch sale price\" />}\n        />\n        <ReferenceLine\n          y={p1}\n          yAxisId=\"left\"\n          stroke={theme.palette.primary.main}\n          strokeDasharray=\"9 0\"\n          label={<ReferenceLabel text=\"After hatch price\" />}\n        />\n\n        {/* Capital collected from withdraw fees - AREA */}\n        <Area\n          isAnimationActive={false}\n          yAxisId=\"right\"\n          type=\"monotone\"\n          dataKey={keyVerticalRight}\n          stroke={theme.palette.secondary.dark}\n          fill={theme.palette.secondary.dark}\n          fillOpacity=\"0.8\"\n        />\n\n        {/* <ReferenceLine\n          x={R0}\n          stroke=\"#90a4ae\"\n          strokeDasharray=\"6 3\"\n          label={<ReferenceLabel />}\n        /> */}\n        <Legend formatter={renderColorfulLegendText} />\n      </AreaChart>\n    </ResponsiveContainer>\n  );\n}\n\nexport default PriceSimulationChart;\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Popover from \"@material-ui/core/Popover\";\nimport Box from \"@material-ui/core/Box\";\nimport HelpIcon from \"@material-ui/icons/HelpOutline\";\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: \"flex\",\n    marginLeft: \"6px\",\n    fontSize: \"0.9rem\",\n    cursor: \"pointer\",\n    transition: \"opacity ease 150ms\",\n    opacity: 0.2,\n    \"&:hover\": {\n      opacity: 0.85\n    }\n  },\n  popoverContainer: {\n    padding: theme.spacing(2)\n  },\n  paper: {\n    backgroundColor: \"#384b59\",\n    maxWidth: theme.breakpoints.values.md * 0.9,\n    [`@media screen and (max-width: ${theme.breakpoints.values.md}px)`]: {\n      maxWidth: \"90vw\"\n    }\n  }\n}));\n\nexport default function SimplePopover({ text }: { text: any }) {\n  const classes = useStyles();\n  const [anchorEl, setAnchorEl] = React.useState(null);\n\n  function handleClick(e: any) {\n    setAnchorEl(e.currentTarget);\n  }\n\n  function handleClose() {\n    setAnchorEl(null);\n  }\n\n  const open = Boolean(anchorEl);\n  const id = open ? \"simple-popover\" : undefined;\n\n  return (\n    <div className={classes.container}>\n      <HelpIcon onClick={handleClick} />\n\n      <Popover\n        PaperProps={{\n          className: classes.paper\n        }}\n        id={id}\n        open={open}\n        anchorEl={anchorEl}\n        onClose={handleClose}\n        onClick={handleClose}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"center\"\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"center\"\n        }}\n      >\n        <Box className={classes.popoverContainer}>{text}</Box>\n      </Popover>\n    </div>\n  );\n}\n","import React, { useState, useEffect, useMemo } from \"react\";\n// Material UI\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Box from \"@material-ui/core/Box\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\n// Components\nimport Header from \"./Header\";\nimport CurveDesignInputParams from \"./CurveDesignInputParams\";\nimport SimulationInputParams from \"./SimulationInputParams\";\nimport SupplyVsDemandChart from \"./SupplyVsDemandChart\";\nimport ResultParams from \"./ResultParams\";\nimport PriceSimulationChart from \"./PriceSimulationChart\";\nimport HelpText from \"./HelpText\";\n// Utils\nimport { getLast, getAvg, pause } from \"./utils\";\nimport {\n  getInitialParams,\n  getPriceR,\n  getSlippage,\n  getTxDistribution,\n  getDeltaR_priceGrowth,\n  rv_U\n} from \"./math\";\nimport { throttle } from \"lodash\";\n// General styles\nimport \"./app.css\";\n\nconst headerOffset = 10;\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    mainContainer: {\n      \"& > div:not(:last-child)\": {\n        paddingBottom: theme.spacing(3)\n      },\n      \"& > div\": {\n        \"& > div\": {\n          paddingTop: \"0 !important\"\n        }\n      },\n      paddingBottom: theme.spacing(9)\n    },\n    simulationContainer: {\n      minHeight: \"442px\"\n    },\n    paper: {\n      width: \"100%\",\n      height: \"100%\",\n      minHeight: 310,\n      backgroundColor: \"#293640\"\n    },\n    box: {\n      padding: theme.spacing(3, 3)\n    },\n    boxButton: {\n      padding: theme.spacing(3, 3)\n    },\n    boxHeader: {\n      padding: theme.spacing(3, 3),\n      height: theme.spacing(headerOffset),\n      display: \"flex\",\n      alignItems: \"center\",\n      borderBottom: \"1px solid #313d47\"\n    },\n    boxBorderBottom: {\n      borderBottom: \"1px solid #313d47\"\n    },\n    initialRaise: {\n      justifyContent: \"space-between\"\n    },\n    boxChart: {\n      width: \"100%\",\n      height: \"100%\",\n      minHeight: 310,\n      maxHeight: 350,\n      padding: theme.spacing(3, 3),\n      // Correct the chart excessive margins\n      paddingRight: \"5px\",\n      paddingLeft: \"5px\"\n    },\n    boxPlaceholder: {\n      padding: theme.spacing(3, 3),\n      display: \"flex\",\n      height: \"100%\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      color: theme.palette.text.secondary,\n      opacity: 0.4\n    },\n    header: {\n      backgroundColor: \"#0b1216\",\n      color: \"#f8f8f8\",\n      textAlign: \"center\",\n      padding: theme.spacing(3, 0, 6 + headerOffset),\n      marginBottom: -theme.spacing(headerOffset)\n    },\n    button: {\n      // background: \"linear-gradient(290deg, #2ad179, #4ab47c)\", // Green gradient\n      background: \"linear-gradient(290deg, #1880e0, #3873d8)\", // blue gradient\n      color: \"white\"\n    },\n    // Descriptions\n    descriptionContainer: {\n      \"& > div:not(:last-child)\": {\n        paddingBottom: theme.spacing(1),\n        marginBottom: theme.spacing(1),\n        borderBottom: \"1px solid #3f5463\"\n      },\n      \"& td\": {\n        verticalAlign: \"top\",\n        padding: theme.spacing(0.5)\n      }\n    },\n    descriptionTitle: {\n      fontWeight: theme.typography.fontWeightBold,\n      padding: theme.spacing(0.5)\n    },\n    descriptionName: {\n      fontWeight: theme.typography.fontWeightBold\n    }\n  })\n);\n\nconst parameterDescriptions = [\n  {\n    name: \"Initial raise\",\n    text: \"Total funds raised in the hatch period of the ABC launch\"\n  },\n  {\n    name: \"Allocation to funding pool\",\n    text:\n      \"The percentage of the funds raised in the Hatch sale that go directly into the project funding pool to compensate future work done in the project\"\n  },\n  {\n    name: \"Hatch price\",\n    text:\n      \"The price paid per 'ABC token' by community members involved in hatching the project\"\n  },\n  {\n    name: \"Post-hatch price\",\n    text:\n      \"The price of the 'ABC token' when the curve enters the open phase and is live for public participation\"\n  },\n  {\n    name: \"Exit tribute\",\n    text:\n      \"The percentage of funds that are diverted to the project funding pool from community members who exit funds from the project by burning 'ABC tokens' in exchange for collateral\"\n  }\n];\n\nconst resultParameterDescriptions = [\n  {\n    name: \"Total reserve\",\n    text:\n      \"Total DAI in the smart contract reserve at the end of the simulated period\"\n  },\n  {\n    name: \"Funds generated from initial hatch\",\n    text:\n      \"Fraction of the funds (theta) raised during the hatch that go directly to the cause\"\n  },\n  {\n    name: \"Funds generated from exit tributes\",\n    text:\n      \"Cumulative amount of exit tributes collected from only exit /sell transactions\"\n  },\n  {\n    name: \"Average slippage\",\n    text:\n      \"Average of the slippage of each transaction occured during the simulation period\"\n  }\n];\n\nexport default function App() {\n  const [curveParams, setCurveParams] = useState({\n    theta: 0.35, // fraction allocated to reserve (.)\n    p0: 0.1, // Hatch sale price p0 (DAI / token)\n    p1: 0.3, // Return factor (.)\n    wFee: 0.05, // friction coefficient (.)\n    d0: 3e6 // Initial raise, d0 (DAI)\n  });\n\n  const { d0, theta, p0, p1, wFee } = curveParams;\n\n  /**\n   * Throttle the curve update to prevent the expensive chart\n   * to re-render too often\n   */\n  const setCurveParamsThrottle = useMemo(\n    () => throttle(setCurveParams, 250),\n    []\n  );\n\n  // Simulation results\n  const {\n    k, // Invariant power kappa (.)\n    R0, // Initial reserve (DAI)\n    // S0, // initial supply of tokens (token)\n    V0 // invariant coef\n  } = getInitialParams({\n    d0,\n    theta,\n    p0,\n    p1\n  });\n\n  const [priceTimeseries, setPriceTimeseries] = useState([0]);\n  const [withdrawFeeTimeseries, setWithdrawFeeTimeseries] = useState([0]);\n  const [totalReserve, setTotalReserve] = useState(R0);\n  const [withdrawCount, setWithdrawCount] = useState(0);\n  const [avgSlippage, setAvgSlippage] = useState(0);\n  const [avgTxSize, setAvgTxSize] = useState(0);\n  // Simulation state variables\n  const [simulationActive, setSimulationActive] = useState(false);\n  const [simulationRunning, setSimulationRunning] = useState(false);\n\n  useEffect(() => {\n    setSimulationActive(false);\n  }, [curveParams]);\n\n  // #### TEST: Immediate simulation\n\n  async function startSimulation() {\n    // If there's a simulation already active, clear it\n    clearSimulation();\n    await pause(0);\n\n    // Start simulation by setting it to active\n    setSimulationActive(true);\n  }\n\n  function clearSimulation() {\n    // Stop simulation\n    setSimulationActive(false);\n    // Clear simulation variables\n    setWithdrawCount(0);\n    setPriceTimeseries([0]);\n    setWithdrawFeeTimeseries([0]);\n    setAvgSlippage(0);\n  }\n\n  useEffect(() => {\n    let canContinueSimulation = true;\n\n    async function simulateRandomDelta() {\n      const R_t: number[] = [R0];\n      const p_t: number[] = [getPriceR({ R: R0, V0, k })];\n      const wFee_t: number[] = [0];\n      const slippage_t: number[] = [];\n      const avgTxSize_t: number[] = [];\n\n      // Random walk\n      const numSteps = 52;\n\n      // numSteps = 52 take 8ms to run\n      setSimulationRunning(true);\n      for (let t = 0; t < numSteps; t++) {\n        const txsWeek = Math.ceil(t < 5 ? rv_U(0, 5) : rv_U(5, 2 * t));\n        const priceGrowth = rv_U(0.99, 1.03);\n\n        const R = getLast(R_t);\n        const deltaR = getDeltaR_priceGrowth({ R, k, priceGrowth });\n\n        const R_next = R + deltaR;\n\n        const txs = getTxDistribution({ sum: deltaR, num: txsWeek });\n        // Compute slippage\n        const slippage = getAvg(\n          txs.map(txR => getSlippage({ R, deltaR: txR, V0, k }))\n        );\n        const txsWithdraw = txs.filter(tx => tx < 0);\n        const wFees = -wFee * txsWithdraw.reduce((t, c) => t + c, 0);\n        const _avgTxSize =\n          txs.reduce((t, c) => t + Math.abs(c), 0) / txs.length;\n\n        R_t.push(R_next);\n        p_t.push(getPriceR({ R: R_next, V0, k }));\n        slippage_t.push(slippage);\n        avgTxSize_t.push(_avgTxSize);\n        wFee_t.push(getLast(wFee_t) + wFees);\n        setWithdrawCount(c => c + txsWithdraw.length);\n\n        // Stop the simulation if it's no longer active\n        if (!simulationActive || !canContinueSimulation) break;\n      }\n\n      setPriceTimeseries(p_t);\n      setWithdrawFeeTimeseries(wFee_t);\n      setAvgSlippage(getAvg(slippage_t));\n      setAvgTxSize(getAvg(avgTxSize_t));\n      setTotalReserve(getLast(R_t));\n\n      setSimulationRunning(false);\n    }\n\n    if (simulationActive) simulateRandomDelta();\n    // Return an \"unsubscribe\" function that halts the run\n    return () => {\n      canContinueSimulation = false;\n    };\n  }, [simulationActive]);\n\n  const resultFields = [\n    {\n      label: `Total reserve`,\n      value: (+totalReserve.toPrecision(3)).toLocaleString() + \" DAI\"\n    },\n    {\n      label: `Funds generated from initial hatch`,\n      value: Math.round(d0 * theta).toLocaleString() + \" DAI\"\n    },\n    {\n      label: `Funds generated from exit tributes (${withdrawCount} txs)`,\n      value:\n        (+getLast(withdrawFeeTimeseries).toPrecision(3)).toLocaleString() +\n        \" DAI\"\n    },\n    {\n      label: `Average slippage (avg tx size ${Math.round(\n        avgTxSize\n      ).toLocaleString()} DAI)`,\n      value: +(100 * avgSlippage).toFixed(3) + \"%\"\n    }\n  ];\n\n  const classes = useStyles();\n\n  return (\n    <>\n      <header className={classes.header}>\n        <Container fixed>\n          <Header />\n        </Container>\n      </header>\n\n      <Container fixed className={classes.mainContainer}>\n        <Grid container spacing={3}>\n          <Grid item xs={12} sm={12} md={6} lg={4}>\n            <Paper className={classes.paper}>\n              <Box className={classes.boxHeader}>\n                <Typography variant=\"h6\">Curve Design</Typography>\n                <HelpText\n                  text={\n                    <div className={classes.descriptionContainer}>\n                      <div>\n                        <Typography className={classes.descriptionTitle}>\n                          Parameters description:\n                        </Typography>\n                      </div>\n                      <table>\n                        <tbody>\n                          {parameterDescriptions.map(({ name, text }) => (\n                            <tr key={name}>\n                              <td>\n                                <Typography className={classes.descriptionName}>\n                                  {name}\n                                </Typography>\n                              </td>\n                              <td>\n                                <Typography>{text}</Typography>\n                              </td>\n                            </tr>\n                          ))}\n                        </tbody>\n                      </table>\n                    </div>\n                  }\n                />\n              </Box>\n\n              <Box className={`${classes.box} ${classes.boxBorderBottom}`}>\n                <CurveDesignInputParams\n                  curveParams={curveParams}\n                  setCurveParams={setCurveParamsThrottle}\n                />\n              </Box>\n\n              <Box className={`${classes.boxHeader} ${classes.initialRaise}`}>\n                <Typography variant=\"h6\">Run parameters</Typography>\n              </Box>\n\n              <Box className={classes.box}>\n                <SimulationInputParams\n                  curveParams={curveParams}\n                  setCurveParams={setCurveParamsThrottle}\n                />\n              </Box>\n            </Paper>\n          </Grid>\n\n          <Grid item xs={12} sm={12} md={6} lg={8}>\n            <Paper className={classes.paper}>\n              <Box className={classes.boxHeader}>\n                <Typography variant=\"h6\">Preview</Typography>\n                <HelpText\n                  text={\n                    <Typography>\n                      Visualization of the token bonding curve analytic function\n                      on a specific range of reserve [0, 4 * R0]. This result is\n                      deterministic given the current set of parameters and will\n                      never change regardes of the campaign performance, it only\n                      shows how the price will react to reserve changes.\n                    </Typography>\n                  }\n                />\n              </Box>\n\n              <Box className={classes.boxChart}>\n                <SupplyVsDemandChart theta={theta} d0={d0} p0={p0} p1={p1} />\n              </Box>\n            </Paper>\n          </Grid>\n        </Grid>\n\n        <Grid container spacing={3}>\n          <Grid item xs={12} md={12}>\n            <Paper>\n              <Box className={classes.boxHeader}>\n                <Grid\n                  container\n                  direction=\"row\"\n                  justify=\"center\"\n                  alignItems=\"center\"\n                >\n                  <Button\n                    variant=\"contained\"\n                    className={classes.button}\n                    onClick={startSimulation}\n                    disabled={simulationRunning}\n                  >\n                    Run simulation\n                  </Button>\n                </Grid>\n              </Box>\n            </Paper>\n          </Grid>\n        </Grid>\n\n        <Grid container spacing={3} className={classes.simulationContainer}>\n          {simulationActive ? (\n            <>\n              <Grid item xs={12} sm={12} md={6} lg={8}>\n                <Paper className={classes.paper}>\n                  <Box className={classes.boxHeader}>\n                    <Typography variant=\"h6\">Simulation</Typography>\n                    <HelpText\n                      text={\n                        <Typography>\n                          This chart shows a 52 week simulation of discrete\n                          transactions interacting with the token bonding curve.\n                          Each transaction adds or substract reserve to the\n                          system, modifying the price over time. The frequency,\n                          size and direction of each transaction is computed\n                          from a set of bounded random functions.\n                        </Typography>\n                      }\n                    />\n                  </Box>\n\n                  <Box className={classes.boxChart}>\n                    <PriceSimulationChart\n                      priceTimeseries={priceTimeseries}\n                      withdrawFeeTimeseries={withdrawFeeTimeseries}\n                      p0={p0}\n                      p1={p1}\n                    />\n                  </Box>\n                </Paper>\n              </Grid>\n\n              <Grid item xs={12} sm={12} md={6} lg={4}>\n                <Paper className={classes.paper}>\n                  <Box className={classes.boxHeader}>\n                    <Typography variant=\"h6\">Results</Typography>\n                    <HelpText\n                      text={\n                        <div className={classes.descriptionContainer}>\n                          <div>\n                            <Typography className={classes.descriptionTitle}>\n                              Result parameters description:\n                            </Typography>\n                          </div>\n                          <table>\n                            <tbody>\n                              {resultParameterDescriptions.map(\n                                ({ name, text }) => (\n                                  <tr key={name}>\n                                    <td>\n                                      <Typography\n                                        className={classes.descriptionName}\n                                      >\n                                        {name}\n                                      </Typography>\n                                    </td>\n                                    <td>\n                                      <Typography>{text}</Typography>\n                                    </td>\n                                  </tr>\n                                )\n                              )}\n                            </tbody>\n                          </table>\n                        </div>\n                      }\n                    />\n                  </Box>\n\n                  <Box className={classes.box}>\n                    <ResultParams resultFields={resultFields} />\n                  </Box>\n                </Paper>\n              </Grid>\n            </>\n          ) : (\n            <Grid item xs={12}>\n              <Paper className={classes.paper}>\n                <Box className={classes.boxPlaceholder}>\n                  <Typography variant=\"h6\">\n                    Run a simulation to see results\n                  </Typography>\n                </Box>\n              </Paper>\n            </Grid>\n          )}\n        </Grid>\n      </Container>\n    </>\n  );\n}\n","import red from \"@material-ui/core/colors/red\";\nimport { createMuiTheme } from \"@material-ui/core/styles\";\n\n// A custom theme for this app\nconst theme = createMuiTheme({\n  palette: {\n    type: \"dark\",\n    primary: {\n      main: \"#2ecd79\"\n    },\n    secondary: {\n      main: \"#116be0\",\n      light: \"#0f8bff\",\n      dark: \"#116be0\"\n    },\n    error: {\n      main: red.A400\n    },\n    background: {\n      default: \"#fff\",\n      paper: \"#293640\"\n    },\n    text: {\n      primary: \"#fff\",\n      secondary: \"#9aa3ad\"\n    }\n  },\n  typography: {\n    h6: {\n      fontWeight: 400\n    }\n  }\n});\n\nconsole.log(theme);\n\nexport default theme;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { ThemeProvider } from '@material-ui/styles';\nimport App from './App';\nimport theme from './theme';\n\nReactDOM.render(\n  <ThemeProvider theme={theme}>\n    {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\n    <CssBaseline />\n    <App />\n  </ThemeProvider>,\n  document.querySelector('#root'),\n);\n"],"sourceRoot":""}