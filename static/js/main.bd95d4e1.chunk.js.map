{"version":3,"sources":["Header.tsx","PrettoSlider.tsx","TextWithPopover.tsx","InputParams.tsx","parametersDescriptions.ts","CurveDesignInputParams.tsx","SimulationInputParams.tsx","utils.ts","math.ts","SupplyVsDemandChart.tsx","ResultParams.tsx","PriceSimulationChart.tsx","HelpText.tsx","App.tsx","theme.tsx","index.tsx"],"names":["cadCadLink","useStyles","makeStyles","theme","createStyles","title","subtitle","color","palette","text","secondary","margin","spacing","subsubtitle","opacity","lightBulb","verticalAlign","marginRight","link","primary","main","logoContainer","display","alignItems","justifyContent","marginBottom","logo","width","logoText","fontSize","fontWeight","Header","classes","react_default","a","createElement","Fragment","className","src","alt","Typography","variant","Link","href","withStyles","root","height","thumb","backgroundColor","border","marginTop","marginLeft","&:focus,&:hover,&$active","boxShadow","active","valueLabel","left","track","borderRadius","rail","markLabel","top","Slider","_paper","container","cursor","transition","&:hover","popoverContainer","padding","& > p:not(:last-child)","paddingBottom","borderBottom","paper","maxWidth","breakpoints","values","md","Object","defineProperty","concat","descriptionBody","TextWithPopover","_ref","content","popoverText","_React$useState","React","useState","_React$useState2","slicedToArray","anchorEl","setAnchorEl","handleClose","open","Boolean","id","undefined","aria-describedby","onClick","event","currentTarget","gutterBottom","Popover","PaperProps","onClose","anchorOrigin","vertical","horizontal","transformOrigin","Box","leftContainer","centerContainer","listBoxContainer","& > div:not(:last-child)","listBox","& > div","& p","paddingRight","slider","secondaryColor","light","NumberFormatCustom","props","inputRef","onChange","prefix","suffix","other","objectWithoutProperties","number_format_default","assign","getInputRef","onValueChange","target","value","thousandSeparator","InputParams","inputFields","onChangeCommited","map","_ref2","label","description","setter","min","max","step","format","toText","toNum","sanitizeInput","num","arguments","length","isNaN","Grid","key","item","xs","TextField","e","parseFloat","InputProps","inputComponent","disableUnderline","inputProps","PrettoSlider","valueLabelDisplay","aria-label","defaultValue","_","newValue","Number","onChangeCommitted","valueLabelFormat","replace","parameterDescriptions","theta","name","p0","p1","wFee","d0","simulationParameterDescriptions","price","floorPrice","exitTributes","resultParameterDescriptions","totalReserve","initialHatchFunds","slippage","CurveDesignInputParams","curveParams","setCurveParams","_useState","_useState2","setTheta","_useState3","_useState4","setP0","_useState5","_useState6","setP1","_useState7","_useState8","setWFee","useEffect","maxReturnRate","n","Math","round","String","toFixed","newP0","params","objectSpread","setD0","floor","linspace","_ref$from","from","to","steps","arr","x","push","getLinspaceTicks","data","desiredPoints","getLast","getAvg","reduce","t","c","abs","pause","ms","Promise","r","setTimeout","getInitialParams","k","R0","S0","V0","pow","getR","S","getS","_ref3","R","getMinPrice","_ref4","H","myP","getPriceR","_ref5","getSlippage","_ref6","deltaR","realizedPrice","spotPrice","getDeltaR_priceGrowth","_ref7","priceGrowth","getTxDistribution","_ref8","sum","mean","off","spread","i","randn_bm","vest_tokens","_ref9","week","halflife","cliff","rv_U","random","u","v","sqrt","log","cos","PI","getMedian","mid","nums","toConsumableArray","sort","b","keyHorizontal","keyVertical","tooltip","SupplyVsDemandChart","_getInitialParams","R0_round","f","biggest","scaling","unit","_data$push","useTheme","formatter","toPrecision","toLocaleString","es6","debounce","right","bottom","strokeDasharray","interval","dataKey","tickFormatter","tick","fill","stroke","ticks","d","domain","payload","supply","reserve","toolTipData","isAnimationActive","type","fillOpacity","strokeWidth","textAnchor","viewBox","y","style","ResultParams","resultFields","keyVerticalLeft","keyVerticalRight","keyVerticalLeft2","PriceSimulationChart","priceTimeseries","withdrawFeeTimeseries","floorpriceTimeseries","ReferenceLabel","yAxisId","apply","slice","orientation","exit","weekNum","dark","SimplePopover","HelpOutline_default","mainContainer","paddingTop","simulationContainer","minHeight","box","boxButton","boxHeader","boxBorderBottom","initialRaise","boxChart","maxHeight","paddingLeft","boxPlaceholder","header","textAlign","button","background","descriptionContainer","& td","descriptionTitle","descriptionPadding","createMuiTheme","error","red","A400","default","typography","h6","console","ReactDOM","render","ThemeProvider","CssBaseline","setCurveParamsThrottle","useMemo","throttle","setPriceTimeseries","setWithdrawFeeTimeseries","setFloorpriceTimeseries","_useState9","_useState10","setTotalReserve","_useState11","_useState12","withdrawCount","setWithdrawCount","_useState13","_useState14","avgSlippage","setAvgSlippage","_useState15","_useState16","avgTxSize","setAvgTxSize","_useState17","_useState18","simulationActive","setSimulationActive","_useState19","_useState20","simulationRunning","setSimulationRunning","_startSimulation","asyncToGenerator","regenerator_default","mark","_callee2","wrap","_context2","prev","next","stop","this","canContinueSimulation","_simulateRandomDelta","_callee","R_t","S_t","p_t","wFee_t","slippage_t","avgTxSize_t","H_t","floorprice_t","numSteps","_loop","_context","txsWeek","u_lower","R_ratio","R_next","txs","txR","txsWithdraw","filter","tx","wFees","H_next","S_next","floorprice_next","_avgTxSize","abrupt","simulateRandomDelta","Container","fixed","sm","lg","Paper","SimulationInputParams_CurveDesignInputParams","src_SupplyVsDemandChart","direction","justify","Button","disabled","src_PriceSimulationChart","document","querySelector"],"mappings":"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","file":"static/js/main.bd95d4e1.chunk.js","sourcesContent":["import React from \"react\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport Link from \"@material-ui/core/Link\";\nimport Typography from \"@material-ui/core/Typography\";\n\nconst cadCadLink =\n  \"https://medium.com/block-science/cadcad-filling-a-critical-gap-in-open-source-data-science-fcd0d3faa8ed\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    title: {\n      // color: theme.palette.text.secondary,\n    },\n    subtitle: {\n      color: theme.palette.text.secondary,\n      margin: theme.spacing(3, 0, 0)\n    },\n    subsubtitle: {\n      color: theme.palette.text.secondary,\n      opacity: 0.6\n    },\n    lightBulb: {\n      verticalAlign: \"middle\",\n      marginRight: theme.spacing(1)\n    },\n    link: {\n      color: theme.palette.primary.main\n    },\n    logoContainer: {\n      display: \"flex\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      marginBottom: theme.spacing(4)\n    },\n    logo: {\n      width: \"25px\",\n      marginRight: \"4px\"\n    },\n    logoText: {\n      display: \"inline\",\n      fontSize: \"1.1rem\",\n      fontWeight: 500\n    }\n  })\n);\n\nexport default function Header() {\n  const classes = useStyles();\n  return (\n    <>\n      <div className={classes.logoContainer}>\n        <img src=\"./favicon.ico\" className={classes.logo} alt=\"logo\" />\n        <Typography className={classes.logoText}>Commons Stack</Typography>\n      </div>\n\n      <Typography className={classes.title} variant=\"h4\">\n        Augmented Token Bonding Curve Design\n      </Typography>\n\n      <Typography className={classes.subtitle}>\n        Experiment and test augmented token bonding curves\n      </Typography>\n      <Typography className={classes.subsubtitle}>\n        A narrative showcase of <Link href={cadCadLink}>cadCAD</Link>\n        's capabilities\n      </Typography>\n    </>\n  );\n}\n","import { withStyles } from \"@material-ui/core/styles\";\nimport Slider from \"@material-ui/core/Slider\";\n\nexport default withStyles({\n  root: {\n    height: 8\n  },\n  thumb: {\n    height: 24,\n    width: 24,\n    backgroundColor: \"#fff\",\n    border: \"2px solid currentColor\",\n    marginTop: -8,\n    marginLeft: -12,\n    \"&:focus,&:hover,&$active\": {\n      boxShadow: \"inherit\"\n    }\n  },\n  active: {},\n  valueLabel: {\n    left: \"calc(-50% + 4px)\"\n  },\n  track: {\n    height: 8,\n    borderRadius: 4\n  },\n  rail: {\n    height: 8,\n    borderRadius: 4\n  },\n  markLabel: {\n    top: 30\n  }\n})(Slider);\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Popover from \"@material-ui/core/Popover\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Box from \"@material-ui/core/Box\";\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    color: theme.palette.text.secondary,\n    display: \"flex\",\n    marginLeft: \"6px\",\n    fontSize: \"0.9rem\",\n    cursor: \"pointer\",\n    transition: \"color ease 150ms\",\n    \"&:hover\": {\n      color: \"#c3c9d0\"\n    }\n  },\n  popoverContainer: {\n    padding: theme.spacing(2),\n    \"& > p:not(:last-child)\": {\n      paddingBottom: theme.spacing(1),\n      marginBottom: theme.spacing(1),\n      borderBottom: \"1px solid #3f5463\"\n    }\n  },\n  paper: {\n    backgroundColor: \"#384b59\",\n    maxWidth: theme.breakpoints.values.md * 0.9,\n    [`@media screen and (max-width: ${theme.breakpoints.values.md}px)`]: {\n      maxWidth: \"90vw\"\n    },\n    padding: theme.spacing(0.5)\n  },\n  descriptionBody: {\n    color: \"#dbdfe4\"\n  }\n}));\n\nexport default function TextWithPopover({\n  content,\n  popoverText\n}: {\n  content: string;\n  popoverText: string;\n}) {\n  const classes = useStyles();\n  const [anchorEl, setAnchorEl] = React.useState(null);\n\n  function handleClick(event: any) {\n    setAnchorEl(event.currentTarget);\n  }\n\n  function handleClose() {\n    setAnchorEl(null);\n  }\n\n  const open = Boolean(anchorEl);\n  const id = open ? \"simple-popover\" : undefined;\n\n  return (\n    <div className={classes.container}>\n      <div aria-describedby={id} onClick={handleClick}>\n        <Typography gutterBottom>{content}</Typography>\n      </div>\n      <Popover\n        PaperProps={{\n          className: classes.paper\n        }}\n        id={id}\n        open={open}\n        anchorEl={anchorEl}\n        onClose={handleClose}\n        onClick={handleClose}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"center\"\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"center\"\n        }}\n      >\n        <Box className={classes.popoverContainer}>\n          <Typography>{content}</Typography>\n          <Typography className={classes.descriptionBody}>\n            {popoverText}\n          </Typography>\n        </Box>\n      </Popover>\n    </div>\n  );\n}\n","import React from \"react\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport Grid from \"@material-ui/core/Grid\";\nimport TextField from \"@material-ui/core/TextField\";\nimport NumberFormat from \"react-number-format\";\nimport { InputFieldInterface } from \"./types\";\nimport PrettoSlider from \"./PrettoSlider\";\nimport TextWithPopover from \"./TextWithPopover\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      margin: theme.spacing(6, 0, 3)\n    },\n    lightBulb: {\n      verticalAlign: \"middle\",\n      marginRight: theme.spacing(1)\n    },\n    leftContainer: {\n      color: theme.palette.text.secondary\n    },\n    centerContainer: {\n      // color: blackColor\n    },\n    listBoxContainer: {\n      \"& > div:not(:last-child)\": {\n        paddingBottom: \"12px\",\n        marginBottom: \"12px\",\n        borderBottom: \"1px solid #313d47\"\n      }\n    },\n    listBox: {\n      \"& > div\": {\n        display: \"flex\",\n        alignItems: \"center\",\n        \"& p\": {\n          marginBottom: 0\n        }\n      },\n      \"& > div:not(:last-child)\": {\n        paddingRight: \"12px\"\n      }\n    },\n    slider: {\n      color: theme.palette.primary.main\n    },\n    secondaryColor: {\n      color: theme.palette.secondary.light\n    }\n  })\n);\n\nfunction NumberFormatCustom(props: any) {\n  const { inputRef, onChange, prefix, suffix, ...other } = props;\n\n  return (\n    <NumberFormat\n      {...other}\n      getInputRef={inputRef}\n      onValueChange={values => {\n        onChange({ target: { value: values.value } });\n      }}\n      thousandSeparator\n      prefix={prefix}\n      suffix={suffix}\n    />\n  );\n}\n\nexport default function InputParams({\n  inputFields,\n  onChangeCommited\n}: {\n  inputFields: InputFieldInterface[];\n  onChangeCommited(): void;\n}) {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.listBoxContainer}>\n      {inputFields.map(\n        ({\n          label,\n          description,\n          value,\n          setter,\n          min,\n          max,\n          step,\n          prefix,\n          suffix,\n          secondaryColor,\n          format,\n          toText,\n          toNum\n        }) => {\n          function sanitizeInput(num: number = 0) {\n            if (isNaN(num)) num = 0;\n            if (num > max) num = max;\n            else if (num < min) num = min;\n            setter(num);\n          }\n\n          return (\n            <Grid key={label} container spacing={0} className={classes.listBox}>\n              <Grid item xs={6} className={classes.leftContainer}>\n                <TextWithPopover content={label} popoverText={description} />\n              </Grid>\n\n              <Grid item xs={2} className={classes.centerContainer}>\n                {/* <Typography gutterBottom>{display(value)}</Typography> */}\n                <TextField\n                  onChange={e => {\n                    sanitizeInput(\n                      toNum ? toNum(e.target.value) : parseFloat(e.target.value)\n                    );\n                    onChangeCommited();\n                  }}\n                  InputProps={{\n                    inputComponent: NumberFormatCustom,\n                    disableUnderline: true,\n                    inputProps: {\n                      prefix,\n                      suffix\n                    }\n                  }}\n                  value={toText ? toText(value) : value}\n                />\n              </Grid>\n\n              <Grid item xs={4}>\n                <PrettoSlider\n                  className={`${classes.slider} ${\n                    secondaryColor ? classes.secondaryColor : \"\"\n                  }`}\n                  valueLabelDisplay=\"auto\"\n                  aria-label={label}\n                  defaultValue={value}\n                  onChange={(_, newValue) => sanitizeInput(Number(newValue))}\n                  onChangeCommitted={onChangeCommited}\n                  value={value}\n                  min={min}\n                  max={max}\n                  step={step}\n                  valueLabelFormat={value => format(value).replace(\"$\", \"\")}\n                />\n              </Grid>\n            </Grid>\n          );\n        }\n      )}\n    </div>\n  );\n}\n","export interface DescriptionObject {\n  [key: string]: { name: string; text: string };\n}\n\nexport const parameterDescriptions: DescriptionObject = {\n  theta: {\n    name: \"Allocation to funding pool\",\n    text:\n      \"The percentage of the funds raised in the Hatch sale that go directly into the project funding pool to compensate future work done in the project\"\n  },\n  p0: {\n    name: \"Hatch price\",\n    text:\n      \"The price paid per 'ABC token' by community members involved in hatching the project\"\n  },\n  p1: {\n    name: \"Post-hatch price\",\n    text:\n      \"The price of the 'ABC token' when the curve enters the open phase and is live for public participation\"\n  },\n  wFee: {\n    name: \"Exit tribute\",\n    text:\n      \"The percentage of funds that are diverted to the project funding pool from community members who exit funds from the project by burning 'ABC tokens' in exchange for collateral\"\n  },\n  d0: {\n    name: \"Initial raise\",\n    text: \"Total funds raised in the hatch period of the ABC launch\"\n  }\n};\n\nexport const simulationParameterDescriptions: DescriptionObject = {\n  price: {\n    name: \"Price\",\n    text: \"Price of the token over time.\"\n  },\n  floorPrice: {\n    name: \"Floor price\",\n    text:\n      \"Lower bound of the price guaranteed by the vesting of hatch tokens. It decreases over time as more hatch tokens are allowed to be traded\"\n  },\n  exitTributes: {\n    name: \"Total exit tributes\",\n    text:\n      \"Cumulative sum of exit tributes collected from only exit /sell transactions\"\n  }\n};\n\nexport const resultParameterDescriptions: DescriptionObject = {\n  totalReserve: {\n    name: \"Total reserve\",\n    text:\n      \"Total DAI in the smart contract reserve at the end of the simulated period\"\n  },\n  initialHatchFunds: {\n    name: \"Funds generated from initial hatch\",\n    text:\n      \"Fraction of the funds (theta) raised during the hatch that go directly to the cause (analytic result)\"\n  },\n  exitTributes: {\n    name: \"Funds generated from exit tributes\",\n    text: simulationParameterDescriptions.exitTributes.text\n  },\n  slippage: {\n    name: \"Average slippage\",\n    text:\n      \"Average of the slippage of each transaction occured during the simulation period\"\n  }\n};\n","import React, { useState, useEffect } from \"react\";\nimport { InputFieldInterface, CurveParamsInterface } from \"./types\";\nimport InputParams from \"./InputParams\";\nimport { parameterDescriptions } from \"./parametersDescriptions\";\n\nexport default function CurveDesignInputParams({\n  curveParams,\n  setCurveParams\n}: {\n  curveParams: CurveParamsInterface;\n  setCurveParams(newCurveParams: any): void;\n}) {\n  const [theta, setTheta] = useState(0.35); // fraction allocated to reserve (.)\n  const [p0, setP0] = useState(0.1); // Hatch sale Price p0 (DAI / token)\n  const [p1, setP1] = useState(0.3); // Return factor (.)\n  const [wFee, setWFee] = useState(0.05); // friction coefficient (.)\n\n  useEffect(() => {\n    setTheta(curveParams.theta);\n    setP0(curveParams.p0);\n    setP1(curveParams.p1);\n    setWFee(curveParams.wFee);\n  }, [curveParams]);\n\n  function _setP0(newP0: number) {\n    setP0(newP0);\n    if (p1 < newP0) setP1(newP0);\n    else if (p1 > newP0 * maxReturnRate) setP1(newP0 * maxReturnRate);\n  }\n\n  function setParentCurveParams() {\n    setCurveParams((params: CurveParamsInterface) => ({\n      ...params,\n      theta,\n      p0,\n      p1,\n      wFee\n    }));\n  }\n\n  const maxReturnRate = 10;\n\n  const inputFields: InputFieldInterface[] = [\n    {\n      label: \"Allocation to funding pool\",\n      description: parameterDescriptions.theta.text,\n      value: theta,\n      setter: setTheta,\n      min: 0,\n      max: 0.9,\n      step: 0.01,\n      suffix: \"%\",\n      format: (n: number) => `${Math.round(100 * n)}%`,\n      toText: (n: number) => String(+(n * 1e2).toFixed(0)),\n      toNum: (n: string) => parseFloat(n) * 1e-2\n    },\n    {\n      label: \"Hatch price (DAI/token)\",\n      description: parameterDescriptions.p0.text,\n      value: p0,\n      setter: _setP0,\n      min: 0.01,\n      max: 1,\n      step: 0.01,\n      toText: (n: number) => String(+n.toFixed(2)),\n      toNum: (n: string) => parseFloat(n),\n      format: (n: number) => `$${n}`\n    },\n    {\n      label: \"Post-hatch price (DAI/token)\",\n      description: parameterDescriptions.p1.text,\n      value: p1,\n      setter: setP1,\n      min: p0 || 0.1,\n      max: Number((maxReturnRate * p0).toFixed(2)),\n      step: 0.01,\n      toText: (n: number) => String(+n.toFixed(2)),\n      toNum: (n: string) => parseFloat(n),\n      format: (n: number) => `$${n}`\n    },\n    {\n      label: \"Exit tribute\",\n      description: parameterDescriptions.wFee.text,\n      value: wFee,\n      setter: setWFee,\n      min: 0,\n      max: 0.1,\n      step: 0.001,\n      suffix: \"%\",\n      format: (n: number) => `${+(100 * n).toFixed(1)}%`,\n      toText: (n: number) => String(+(n * 1e2).toFixed(1)),\n      toNum: (n: string) => parseFloat(n) * 1e-2\n    }\n  ];\n\n  return (\n    <InputParams\n      inputFields={inputFields}\n      onChangeCommited={setParentCurveParams}\n    />\n  );\n}\n","import React, { useState, useEffect } from \"react\";\nimport { InputFieldInterface, CurveParamsInterface } from \"./types\";\nimport InputParams from \"./InputParams\";\nimport { parameterDescriptions } from \"./parametersDescriptions\";\n\nexport default function CurveDesignInputParams({\n  curveParams,\n  setCurveParams\n}: {\n  curveParams: CurveParamsInterface;\n  setCurveParams(newCurveParams: any): void;\n}) {\n  const [d0, setD0] = useState(3e6); // Initial raise, d0 (DAI)\n\n  useEffect(() => {\n    setD0(curveParams.d0);\n  }, [curveParams]);\n\n  function setParentCurveParams() {\n    setCurveParams((params: CurveParamsInterface) => ({\n      ...params,\n      d0\n    }));\n  }\n\n  const inputFields: InputFieldInterface[] = [\n    {\n      label: \"Initial raise (DAI)\",\n      description: parameterDescriptions.d0.text,\n      value: d0,\n      setter: setD0,\n      min: 0.1e6,\n      max: 10e6,\n      step: 0.1e6,\n      suffix: \"M\",\n      format: (n: number) => `$${+(n * 1e-6).toFixed(1)}M`,\n      toText: (n: number) => String(+(n * 1e-6).toFixed(1)),\n      toNum: (n: string) => Math.floor(parseFloat(n) * 1e6),\n      secondaryColor: true\n    }\n  ];\n\n  return (\n    <InputParams\n      inputFields={inputFields}\n      onChangeCommited={setParentCurveParams}\n    />\n  );\n}\n","/**\n * Returns an equally spaced array of numbers `from`, `to` with `steps`.\n */\nexport function linspace({\n  from = 0,\n  to,\n  steps\n}: {\n  from?: number;\n  to: number;\n  steps: number;\n}) {\n  const arr = [];\n  for (let x = from; x <= to; x += (to - from) / steps) arr.push(x);\n  return arr;\n}\n\n/**\n * Returns a uniform distribution of `num` ticks\n */\nexport function getLinspaceTicks(data: number[], num: number) {\n  const desiredPoints = [];\n  const step = (data[data.length - 1] - data[0]) / num;\n  for (let x = data[0]; x < data[data.length - 1]; x += step) {\n    desiredPoints.push(x);\n  }\n  if (desiredPoints.length < num + 1) desiredPoints.push(data[data.length - 1]);\n\n  return desiredPoints;\n}\n\n/**\n * Returns the last element of an array\n */\nexport function getLast(a: number[]) {\n  return a[a.length - 1];\n}\n\n/**\n * Returns the average of an array\n */\nexport function getAvg(a: number[]) {\n  return a.reduce((t, c) => t + Math.abs(c), 0) / a.length;\n}\n\n/**\n * Waits `ms` miliseconds and resolves\n */\nexport function pause(ms: number) {\n  return new Promise(r => setTimeout(r, ms));\n}\n","/**\n * Computes the initial params given the \"user friendly\" params:\n * - Initial raise, `d0` (DAI)\n * - fraction allocated to reserve, `theta`\n * - Hatch sale price, `p0` (DAI / token)\n * - Return factor, `returnF`\n */\nexport function getInitialParams({\n  d0,\n  theta,\n  p0,\n  p1\n}: {\n  d0: number;\n  theta: number;\n  p0: number;\n  p1: number;\n}) {\n  const k = p1 / p0 / (1 - theta); // Invariant power kappa (.)\n  const R0 = (1 - theta) * d0; // Initial reserve (DAI)\n  const S0 = d0 / p0; // initial supply of tokens (token)\n  const V0 = S0 ** k / R0; // invariant coef\n  return { k, R0, S0, V0 };\n}\n\nexport function getR({ S, V0, k }: { S: number; V0: number; k: number }) {\n  return S ** k / V0;\n}\n\nexport function getS({ R, V0, k }: { R: number; V0: number; k: number }) {\n  return (V0 * R) ** (1 / k);\n}\n\n// compute the price if all that supply is burned\nexport function getMinPrice({\n  S,\n  H,\n  V0,\n  k\n}: {\n  S: number;\n  H: number;\n  V0: number;\n  k: number;\n}) {\n  if (S === H) {\n    const myR = getR({ S, V0, k });\n    const myP = getPriceR({ R: myR, V0, k }); // numerical precision make complex numbers just suppress it\n    return Math.abs(myP);\n  } else {\n    // compute the reserve if all that supply is burned\n    const minR = getR({ S: S - H, V0, k });\n    return getPriceR({ R: minR, V0, k });\n  }\n}\n\n/**\n * Computes the price at a specific reserve `R`\n */\nexport function getPriceR({ R, V0, k }: { R: number; V0: number; k: number }) {\n  return (k * R ** ((k - 1) / k)) / V0 ** (1 / k);\n}\n\n/**\n * Compute slippage at a point `R`, given a `deltaR`\n */\nexport function getSlippage({\n  R,\n  deltaR,\n  V0,\n  k\n}: {\n  R: number;\n  deltaR: number;\n  V0: number;\n  k: number;\n}) {\n  const S = (V0 * R) ** (1 / k);\n  const deltaS = (V0 * (R + deltaR)) ** (1 / k) - S;\n  const realizedPrice = deltaR / deltaS;\n  const spotPrice = getPriceR({ R, V0, k });\n  return Math.abs(realizedPrice - spotPrice) / spotPrice;\n}\n\n// Price walk utils\n\n/**\n * Get deltaR for a given price growth factor\n */\nexport function getDeltaR_priceGrowth({\n  R,\n  k,\n  priceGrowth\n}: {\n  R: number;\n  k: number;\n  priceGrowth: number;\n}) {\n  return -R + (priceGrowth * R ** (1 - 1 / k)) ** (k / (-1 + k));\n}\n\n/**\n * Computes a tx distribution using a normal distribution,\n * Given a sum of tx value and a number of transactions\n *\n * Demo: https://codepen.io/anon/pen/mNqJjv?editors=0010#0\n * Very quick: < 10ms for 10000 txs\n */\nexport function getTxDistribution({\n  sum,\n  num,\n  spread\n}: {\n  sum: number;\n  num: number;\n  spread: number;\n}) {\n  const mean = sum / num;\n  const off = mean * spread;\n  const x: number[] = [];\n  for (let i = 0; i < num; i++) {\n    x.push(randn_bm(mean - off, mean + off));\n  }\n  return x;\n}\n\nexport function vest_tokens({\n  week,\n  H, // unvested_hatch_tokens\n  halflife,\n  cliff\n}: {\n  week: number;\n  H: number;\n  halflife: number;\n  cliff: number;\n}) {\n  // check cliff\n  if (week < cliff) {\n    return 0;\n  } else {\n    // rate of release given half - life\n    const vest_fraction = 0.5 ** (1 / halflife);\n    // number of tokens that vest in this week\n    return H * (1 - vest_fraction);\n  }\n}\n\n// Statistics utils\n\n/**\n * Random variable uniformly distributed\n */\nexport function rv_U(min: number, max: number) {\n  return Math.random() * (max - min) + min;\n}\n\n/**\n * Standard Normal variate using Box-Muller transform.\n * by https://stackoverflow.com/questions/25582882/javascript-math-random-normal-distribution-gaussian-bell-curve/36481059#36481059\n */\nfunction randn_bm(min: number, max: number) {\n  var u = 0,\n    v = 0;\n  while (u === 0) u = Math.random(); //Converting [0,1) to (0,1)\n  while (v === 0) v = Math.random();\n  let num = Math.sqrt(-2.0 * Math.log(u)) * Math.cos(2.0 * Math.PI * v);\n\n  num = num / 10.0 + 0.5; // Translate to 0 -> 1\n  if (num > 1 || num < 0) num = randn_bm(min, max); // resample between 0 and 1 if out of range\n  num *= max - min; // Stretch to fill range\n  num += min; // offset to min\n  return num;\n}\n\n// Array utils\n\nexport function getMedian(arr: number[]) {\n  const mid = Math.floor(arr.length / 2);\n  const nums = [...arr].sort((a, b) => a - b);\n  return arr.length % 2 !== 0 ? nums[mid] : (nums[mid - 1] + nums[mid]) / 2;\n}\n\nexport function getSum(arr: number[]) {\n  return arr.reduce((a, b) => a + b, 0);\n}\n","import React from \"react\";\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Legend,\n  ReferenceLine,\n  ResponsiveContainer,\n  Tooltip\n} from \"recharts\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport { getLinspaceTicks } from \"./utils\";\nimport { getInitialParams, getPriceR } from \"./math\";\nimport { useTheme } from \"@material-ui/styles\";\n\nconst keyHorizontal = \"x\";\nconst keyVertical = \"Supply (tokens) / Reserve (DAI)\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    tooltip: {\n      border: \"1px solid #313d47\",\n      backgroundColor: \"#384b59\",\n      padding: theme.spacing(1),\n      color: \"#c7ccd2\"\n    }\n  })\n);\n\nfunction SupplyVsDemandChart({\n  theta,\n  d0,\n  p0,\n  p1\n}: {\n  theta: number;\n  d0: number;\n  p0: number;\n  p1: number;\n}) {\n  // d0      - Initial raise, d0 (DAI)\n  // theta   - fraction allocated to reserve (.)\n  // p0      - Hatch sale Price p0 (DAI / token)\n  // returnF - Return factor (.)\n  // wFee    - friction coefficient (.)\n\n  // Hatch parameters\n  const {\n    k, // Invariant power kappa (.)\n    R0, // Initial reserve (DAI)\n    S0, // initial supply of tokens (token)\n    V0 // invariant coef\n  } = getInitialParams({\n    d0,\n    theta,\n    p0,\n    p1\n  });\n  const R0_round = Math.round(R0);\n  const S_of_R = (R: number) => S0 * (R / R0_round) ** (1 / k);\n\n  // Function setup\n  const f = S_of_R;\n  const from = 0;\n  const to = 4 * R0_round;\n  const steps = 100 + 1; // Add 1 for the ticks to match\n  const step = Math.round((to - from) / (steps - 1));\n\n  /**\n   * Prettify the result converting 1000000 to 1M\n   */\n  const biggest = Math.max(to, f(to));\n  const [scaling, unit] =\n    // Billion\n    biggest > 0.5e9\n      ? [1e9, \"B\"]\n      : // Million\n      biggest > 0.5e6\n      ? [1e6, \"M\"]\n      : // 1 thousand\n      biggest > 0.5e3\n      ? [1e3, \"K\"]\n      : // No scale\n        [1, \"\"];\n\n  const data = [];\n  for (let i = 0; i < steps; i++) {\n    const x = Math.round(from + step * i);\n    data.push({\n      [keyHorizontal]: x,\n      [keyVertical]: f(x)\n    });\n  }\n\n  // Chart components\n\n  const theme: any = useTheme();\n  const classes = useStyles();\n\n  const formatter = (n: number) =>\n    (+(n / scaling).toPrecision(2)).toLocaleString();\n\n  function renderColorfulLegendText(value: string) {\n    return <span style={{ color: theme.palette.text.secondary }}>{value}</span>;\n  }\n\n  function ReferenceLabel(props: any) {\n    const { textAnchor, viewBox } = props;\n    return (\n      <text\n        x={viewBox.x + 10}\n        y={30}\n        fill={theme.palette.text.secondary}\n        textAnchor={textAnchor}\n      >\n        Initial value\n      </text>\n    );\n  }\n\n  function CustomTooltip({ active, payload, label }: any) {\n    if (active) {\n      const supply = payload[0].value;\n      const reserve = label;\n      const price = getPriceR({ R: reserve, V0, k });\n      const toolTipData: string[][] = [\n        [\"Supply\", formatter(supply) + unit, \"tokens\"],\n        [\"Reserve\", formatter(reserve) + unit, \"DAI\"],\n        [\"Price\", price.toFixed(2), \"DAI/token\"]\n      ];\n      return (\n        <div className={classes.tooltip}>\n          <table>\n            <tbody>\n              {toolTipData.map(([name, value, unit]) => (\n                <tr key={name}>\n                  <td>{name}</td>\n                  <td>{value}</td>\n                  <td>{unit}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      );\n    } else return null;\n  }\n\n  return (\n    <ResponsiveContainer debounce={1}>\n      <AreaChart\n        width={0}\n        height={400}\n        data={data}\n        margin={{\n          top: 10,\n          right: 30,\n          left: 0,\n          bottom: 0\n        }}\n      >\n        <CartesianGrid strokeDasharray=\"3 3\" />\n        <XAxis\n          interval={24}\n          dataKey={keyHorizontal}\n          tickFormatter={formatter}\n          unit={unit}\n          tick={{ fill: theme.palette.text.secondary }}\n          stroke={theme.palette.text.secondary}\n        />\n        <YAxis\n          interval={\"preserveStartEnd\"}\n          ticks={getLinspaceTicks(data.map(d => d[keyVertical]), 3)}\n          tickFormatter={formatter}\n          unit={unit}\n          tick={{ fill: theme.palette.text.secondary }}\n          domain={[0, f(to)]}\n          stroke={theme.palette.text.secondary}\n        />\n        <Tooltip content={<CustomTooltip />} />\n        <Area\n          isAnimationActive={false}\n          type=\"monotone\"\n          dataKey={keyVertical}\n          stroke={theme.palette.primary.main}\n          fill={theme.palette.primary.main}\n          fillOpacity={0.3}\n          strokeWidth={2}\n        />\n        <ReferenceLine\n          x={R0_round}\n          stroke={theme.palette.primary.main}\n          strokeDasharray=\"9 0\"\n          label={<ReferenceLabel />}\n        />\n        <Legend formatter={renderColorfulLegendText} />\n      </AreaChart>\n    </ResponsiveContainer>\n  );\n}\n\nexport default SupplyVsDemandChart;\n","import React from \"react\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Grid from \"@material-ui/core/Grid\";\nimport TextWithPopover from \"./TextWithPopover\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    root: {\n      margin: theme.spacing(6, 0, 3)\n    },\n    lightBulb: {\n      verticalAlign: \"middle\",\n      marginRight: theme.spacing(1)\n    },\n    leftContainer: {\n      color: theme.palette.text.secondary\n    },\n    centerContainer: {\n      // color: blackColor\n    },\n    listBoxContainer: {\n      \"& > div:not(:last-child)\": {\n        marginBottom: \"12px\",\n        borderBottom: \"1px solid #313d47\"\n      }\n    },\n    listBox: {\n      paddingBottom: \"12px\",\n      \"& > div\": {\n        display: \"flex\",\n        alignItems: \"center\",\n        \"& p\": {\n          marginBottom: 0\n        }\n      },\n      \"& > div:not(:last-child)\": {\n        paddingRight: \"12px\"\n      }\n    }\n  })\n);\n\nexport default function ResultParams({\n  resultFields\n}: {\n  resultFields: {\n    label: string;\n    description: string;\n    value: number | string;\n  }[];\n}) {\n  const classes = useStyles();\n\n  return (\n    <div className={classes.listBoxContainer}>\n      {resultFields.map(({ label, description, value }) => (\n        <Grid key={label} container spacing={0} className={classes.listBox}>\n          <Grid item xs={8} className={classes.leftContainer}>\n            <TextWithPopover content={label} popoverText={description} />\n          </Grid>\n\n          <Grid item xs={4} className={classes.centerContainer}>\n            <Typography gutterBottom>{value}</Typography>\n          </Grid>\n        </Grid>\n      ))}\n    </div>\n  );\n}\n","import React from \"react\";\nimport {\n  AreaChart,\n  Area,\n  XAxis,\n  YAxis,\n  CartesianGrid,\n  Legend,\n  ReferenceLine,\n  ResponsiveContainer,\n  Tooltip\n} from \"recharts\";\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport { useTheme } from \"@material-ui/styles\";\nimport { linspace } from \"./utils\";\n\nconst keyHorizontal = \"x\";\nconst keyVerticalLeft = \"Price (DAI/token)\";\nconst keyVerticalRight = \"Total exit tributes (DAI)\";\nconst keyVerticalLeft2 = \"Floor price (DAI/token)\";\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    tooltip: {\n      border: \"1px solid #313d47\",\n      backgroundColor: \"#384b59\",\n      padding: theme.spacing(1),\n      color: \"#c7ccd2\"\n    }\n  })\n);\n\nfunction PriceSimulationChart({\n  priceTimeseries,\n  withdrawFeeTimeseries,\n  floorpriceTimeseries,\n  p0,\n  p1\n}: {\n  priceTimeseries: number[];\n  withdrawFeeTimeseries: number[];\n  floorpriceTimeseries: number[];\n  p0: number;\n  p1: number;\n}) {\n  // d0      - Initial raise, d0 (DAI)\n  // theta   - fraction allocated to reserve (.)\n  // p0      - Hatch sale Price p0 (DAI / token)\n  // returnF - Return factor (.)\n  // wFee    - friction coefficient (.)\n\n  const data = [];\n  for (let t = 0; t < priceTimeseries.length; t++) {\n    data.push({\n      [keyHorizontal]: t,\n      [keyVerticalLeft]: priceTimeseries[t] || 0,\n      [keyVerticalLeft2]: floorpriceTimeseries[t] || 0,\n      [keyVerticalRight]: withdrawFeeTimeseries[t] || 0\n    });\n  }\n\n  // Chart components\n\n  const theme: any = useTheme();\n  const classes = useStyles();\n\n  function renderColorfulLegendText(value: string) {\n    return <span style={{ color: theme.palette.text.secondary }}>{value}</span>;\n  }\n\n  const formatter = (n: number) => (+n.toPrecision(3)).toLocaleString();\n\n  function ReferenceLabel(props: any) {\n    const { textAnchor, viewBox, text } = props;\n    return (\n      <text\n        x={viewBox.x + 8}\n        y={viewBox.y + 17}\n        fill={theme.palette.text.secondary}\n        textAnchor={textAnchor}\n      >\n        {text}\n      </text>\n    );\n  }\n\n  function CustomTooltip({ active, payload, label }: any) {\n    if (active) {\n      const price = payload[0].value;\n      const floor = payload[1].value;\n      const exit = payload[2].value;\n      const weekNum = label;\n      const toolTipData: string[][] = [\n        [\"Price\", price.toFixed(2), \"DAI/tk\"],\n        [\"Floor\", floor.toFixed(2), \"DAI/tk\"],\n        [\"Exit t.\", formatter(exit), \"DAI\"],\n        [\"Week\", weekNum, \"\"]\n      ];\n\n      return (\n        <div className={classes.tooltip}>\n          <table>\n            <tbody>\n              {toolTipData.map(([name, value, unit]) => (\n                <tr key={name}>\n                  <td>{name}</td>\n                  <td>{value}</td>\n                  <td>{unit}</td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      );\n    } else return null;\n  }\n\n  return (\n    <ResponsiveContainer debounce={1}>\n      <AreaChart\n        width={0}\n        height={400}\n        data={data}\n        margin={{\n          top: 10,\n          right: 30,\n          left: 0,\n          bottom: 0\n        }}\n      >\n        <CartesianGrid strokeDasharray=\"3 3\" />\n        <XAxis\n          dataKey={keyHorizontal}\n          tick={{ fill: theme.palette.text.secondary }}\n          stroke={theme.palette.text.secondary}\n          ticks={[\n            ...linspace({\n              to: priceTimeseries.length,\n              steps: 4\n            }).map(Math.floor),\n            priceTimeseries.length - 1\n          ]}\n        />\n\n        {/* Price time evolution */}\n        <YAxis\n          yAxisId=\"left\"\n          domain={[0, Math.max(...priceTimeseries, p1 * 1.25)]}\n          tickFormatter={formatter}\n          tick={{ fill: theme.palette.text.secondary }}\n          stroke={theme.palette.text.secondary}\n        />\n\n        {/* Capital collected from withdraw fees - AXIS */}\n        <YAxis\n          yAxisId=\"right\"\n          domain={[0, +(2 * withdrawFeeTimeseries.slice(-1)[0]).toPrecision(1)]}\n          orientation=\"right\"\n          tick={{ fill: theme.palette.text.secondary }}\n          tickFormatter={formatter}\n          stroke={theme.palette.text.secondary}\n        />\n\n        <Tooltip content={<CustomTooltip />} />\n\n        <Area\n          isAnimationActive={false}\n          yAxisId=\"left\"\n          type=\"monotone\"\n          dataKey={keyVerticalLeft}\n          stroke={theme.palette.primary.main}\n          fill={theme.palette.primary.main}\n          fillOpacity={0.3}\n          strokeWidth={2}\n        />\n        <Area\n          isAnimationActive={false}\n          yAxisId=\"left\"\n          type=\"monotone\"\n          dataKey={keyVerticalLeft2}\n          stroke={\"#adcd2e\"}\n          fill={\"#adcd2e\"}\n          fillOpacity={0.05}\n          strokeWidth={2}\n        />\n\n        <ReferenceLine\n          y={p0}\n          yAxisId=\"left\"\n          stroke={theme.palette.primary.main}\n          strokeDasharray=\"9 0\"\n          label={<ReferenceLabel text=\"Hatch sale price\" />}\n        />\n        <ReferenceLine\n          y={p1}\n          yAxisId=\"left\"\n          stroke={theme.palette.primary.main}\n          strokeDasharray=\"9 0\"\n          label={<ReferenceLabel text=\"After hatch price\" />}\n        />\n\n        {/* Capital collected from withdraw fees - AREA */}\n        <Area\n          isAnimationActive={false}\n          yAxisId=\"right\"\n          type=\"monotone\"\n          dataKey={keyVerticalRight}\n          stroke={\"#0085ff\"}\n          fill={theme.palette.secondary.dark}\n          fillOpacity={0.5}\n          strokeWidth={2}\n        />\n\n        {/* <ReferenceLine\n          x={R0}\n          stroke=\"#90a4ae\"\n          strokeDasharray=\"6 3\"\n          label={<ReferenceLabel />}\n        /> */}\n        <Legend formatter={renderColorfulLegendText} />\n      </AreaChart>\n    </ResponsiveContainer>\n  );\n}\n\nexport default PriceSimulationChart;\n","import React from \"react\";\nimport { makeStyles } from \"@material-ui/core/styles\";\nimport Popover from \"@material-ui/core/Popover\";\nimport Box from \"@material-ui/core/Box\";\nimport HelpIcon from \"@material-ui/icons/HelpOutline\";\n\nconst useStyles = makeStyles(theme => ({\n  container: {\n    display: \"flex\",\n    marginLeft: \"6px\",\n    fontSize: \"0.9rem\",\n    cursor: \"pointer\",\n    transition: \"opacity ease 150ms\",\n    opacity: 0.2,\n    \"&:hover\": {\n      opacity: 0.85\n    }\n  },\n  popoverContainer: {\n    padding: theme.spacing(2)\n  },\n  paper: {\n    backgroundColor: \"#384b59\",\n    maxWidth: theme.breakpoints.values.md * 0.9,\n    [`@media screen and (max-width: ${theme.breakpoints.values.md}px)`]: {\n      maxWidth: \"90vw\"\n    }\n  }\n}));\n\nexport default function SimplePopover({ text }: { text: any }) {\n  const classes = useStyles();\n  const [anchorEl, setAnchorEl] = React.useState(null);\n\n  function handleClick(e: any) {\n    setAnchorEl(e.currentTarget);\n  }\n\n  function handleClose() {\n    setAnchorEl(null);\n  }\n\n  const open = Boolean(anchorEl);\n  const id = open ? \"simple-popover\" : undefined;\n\n  return (\n    <div className={classes.container}>\n      <HelpIcon onClick={handleClick} />\n\n      <Popover\n        PaperProps={{\n          className: classes.paper\n        }}\n        id={id}\n        open={open}\n        anchorEl={anchorEl}\n        onClose={handleClose}\n        onClick={handleClose}\n        anchorOrigin={{\n          vertical: \"bottom\",\n          horizontal: \"center\"\n        }}\n        transformOrigin={{\n          vertical: \"top\",\n          horizontal: \"center\"\n        }}\n      >\n        <Box className={classes.popoverContainer}>{text}</Box>\n      </Popover>\n    </div>\n  );\n}\n","import React, { useState, useEffect, useMemo } from \"react\";\n// Material UI\nimport { createStyles, makeStyles, Theme } from \"@material-ui/core/styles\";\nimport Container from \"@material-ui/core/Container\";\nimport Typography from \"@material-ui/core/Typography\";\nimport Box from \"@material-ui/core/Box\";\nimport Paper from \"@material-ui/core/Paper\";\nimport Grid from \"@material-ui/core/Grid\";\nimport Button from \"@material-ui/core/Button\";\n// Components\nimport Header from \"./Header\";\nimport CurveDesignInputParams from \"./CurveDesignInputParams\";\nimport SimulationInputParams from \"./SimulationInputParams\";\nimport SupplyVsDemandChart from \"./SupplyVsDemandChart\";\nimport ResultParams from \"./ResultParams\";\nimport PriceSimulationChart from \"./PriceSimulationChart\";\nimport HelpText from \"./HelpText\";\n// Text content\nimport {\n  parameterDescriptions,\n  simulationParameterDescriptions,\n  resultParameterDescriptions\n} from \"./parametersDescriptions\";\n// Utils\nimport { getLast, getAvg, pause } from \"./utils\";\nimport {\n  getInitialParams,\n  getPriceR,\n  getMinPrice,\n  getS,\n  vest_tokens,\n  getR,\n  getSlippage,\n  getTxDistribution,\n  getDeltaR_priceGrowth,\n  rv_U,\n  getMedian,\n  getSum\n} from \"./math\";\nimport { throttle } from \"lodash\";\n// General styles\nimport \"./app.css\";\n\nconst headerOffset = 10;\n\nconst useStyles = makeStyles((theme: Theme) =>\n  createStyles({\n    mainContainer: {\n      \"& > div:not(:last-child)\": {\n        paddingBottom: theme.spacing(3)\n      },\n      \"& > div\": {\n        \"& > div\": {\n          paddingTop: \"0 !important\"\n        }\n      },\n      paddingBottom: theme.spacing(9)\n    },\n    simulationContainer: {\n      minHeight: \"442px\"\n    },\n    paper: {\n      width: \"100%\",\n      height: \"100%\",\n      minHeight: 310,\n      backgroundColor: \"#293640\"\n    },\n    box: {\n      padding: theme.spacing(3, 3)\n    },\n    boxButton: {\n      padding: theme.spacing(3, 3)\n    },\n    boxHeader: {\n      padding: theme.spacing(3, 3),\n      height: theme.spacing(headerOffset),\n      display: \"flex\",\n      alignItems: \"center\",\n      borderBottom: \"1px solid #313d47\"\n    },\n    boxBorderBottom: {\n      borderBottom: \"1px solid #313d47\"\n    },\n    initialRaise: {\n      justifyContent: \"space-between\"\n    },\n    boxChart: {\n      width: \"100%\",\n      height: \"100%\",\n      minHeight: 310,\n      maxHeight: 350,\n      padding: theme.spacing(3, 3),\n      // Correct the chart excessive margins\n      paddingRight: \"5px\",\n      paddingLeft: \"5px\"\n    },\n    boxPlaceholder: {\n      padding: theme.spacing(3, 3),\n      display: \"flex\",\n      height: \"100%\",\n      alignItems: \"center\",\n      justifyContent: \"center\",\n      color: theme.palette.text.secondary,\n      opacity: 0.4\n    },\n    header: {\n      backgroundColor: \"#0b1216\",\n      color: \"#f8f8f8\",\n      textAlign: \"center\",\n      padding: theme.spacing(3, 0, 6 + headerOffset),\n      marginBottom: -theme.spacing(headerOffset)\n    },\n    button: {\n      // background: \"linear-gradient(290deg, #2ad179, #4ab47c)\", // Green gradient\n      background: \"linear-gradient(290deg, #1880e0, #3873d8)\", // blue gradient\n      color: \"white\"\n    },\n    // Descriptions\n    descriptionContainer: {\n      \"& > div:not(:last-child)\": {\n        paddingBottom: theme.spacing(1),\n        marginBottom: theme.spacing(1),\n        borderBottom: \"1px solid #3f5463\"\n      },\n      \"& td\": {\n        verticalAlign: \"top\",\n        padding: theme.spacing(0.5)\n      }\n    },\n    descriptionTitle: {\n      padding: theme.spacing(0.5)\n    },\n    descriptionBody: {\n      color: \"#dbdfe4\"\n    },\n    descriptionPadding: {\n      padding: theme.spacing(0.5)\n    }\n  })\n);\n\nexport default function App() {\n  const [curveParams, setCurveParams] = useState({\n    theta: 0.35, // fraction allocated to reserve (.)\n    p0: 0.1, // Hatch sale price p0 (DAI / token)\n    p1: 0.3, // Return factor (.)\n    wFee: 0.05, // friction coefficient (.)\n    d0: 3e6 // Initial raise, d0 (DAI)\n  });\n\n  const { d0, theta, p0, p1, wFee } = curveParams;\n\n  /**\n   * Throttle the curve update to prevent the expensive chart\n   * to re-render too often\n   */\n  const setCurveParamsThrottle = useMemo(\n    () => throttle(setCurveParams, 250),\n    []\n  );\n\n  // Simulation results\n  const {\n    k, // Invariant power kappa (.)\n    R0, // Initial reserve (DAI)\n    S0, // initial supply of tokens (token)\n    V0 // invariant coef\n  } = getInitialParams({\n    d0,\n    theta,\n    p0,\n    p1\n  });\n\n  const [priceTimeseries, setPriceTimeseries] = useState([0]);\n  const [withdrawFeeTimeseries, setWithdrawFeeTimeseries] = useState([0]);\n  const [floorpriceTimeseries, setFloorpriceTimeseries] = useState([0]);\n  const [totalReserve, setTotalReserve] = useState(R0);\n  const [withdrawCount, setWithdrawCount] = useState(0);\n  const [avgSlippage, setAvgSlippage] = useState(0);\n  const [avgTxSize, setAvgTxSize] = useState(0);\n  // Simulation state variables\n  const [simulationActive, setSimulationActive] = useState(false);\n  const [simulationRunning, setSimulationRunning] = useState(false);\n\n  useEffect(() => {\n    setSimulationActive(false);\n  }, [curveParams]);\n\n  // #### TEST: Immediate simulation\n\n  async function startSimulation() {\n    // If there's a simulation already active, clear it\n    clearSimulation();\n    await pause(0);\n\n    // Start simulation by setting it to active\n    setSimulationActive(true);\n  }\n\n  function clearSimulation() {\n    // Stop simulation\n    setSimulationActive(false);\n    // Clear simulation variables\n    setWithdrawCount(0);\n    setPriceTimeseries([0]);\n    setWithdrawFeeTimeseries([0]);\n    setAvgSlippage(0);\n  }\n\n  useEffect(() => {\n    let canContinueSimulation = true;\n\n    async function simulateRandomDelta() {\n      const R_t: number[] = [R0];\n      const S_t: number[] = [S0];\n      const p_t: number[] = [getPriceR({ R: R0, V0, k })];\n      const wFee_t: number[] = [0];\n      const slippage_t: number[] = [];\n      const avgTxSize_t: number[] = [];\n\n      // hatchers tokens = S0[section added by Z]\n      const H_t: number[] = [S0]; // total hatcher tokens not vested\n      const floorprice_t: number[] = []; // initially the price is the floor as all tokens are hatcher tokens\n\n      // Random walk\n      const numSteps = 52;\n      const u_min = 0.97;\n      const u_max = 1.04;\n      const tx_spread = 10;\n      // vesting(should this be exposed in the app ?)\n      const cliff = 8; // weeks before vesting starts ~2 months\n      const halflife = 52; // 26 weeks, half life is ~6 months\n      // percentage of the hatch tokens which vest per week(since that is our timescale in the sim)\n\n      // numSteps = 52 take 8ms to run\n      setSimulationRunning(true);\n      for (let t = 0; t < numSteps; t++) {\n        const txsWeek = rv_U(5, 2 * t + 5);\n\n        const R = getLast(R_t);\n        const S = getLast(S_t);\n        const H = getLast(H_t);\n\n        // enforce the effects of the unvested tokens not being burnable\n        let u_lower;\n        if (H > S) {\n          u_lower = 1;\n        } else {\n          // compute the reserve if all that supply is burned\n          const R_ratio = getR({ S: S - H, V0, k }) / R;\n          u_lower = Math.max(1 - R_ratio, u_min);\n        }\n        const priceGrowth = rv_U(u_lower, u_max);\n\n        const deltaR = getDeltaR_priceGrowth({ R, k, priceGrowth });\n        const R_next = R + deltaR;\n\n        const txs = getTxDistribution({\n          sum: deltaR,\n          num: txsWeek,\n          spread: tx_spread\n        });\n        // Compute slippage\n        const slippage_txs = txs.map(txR =>\n          getSlippage({ R, deltaR: txR, V0, k })\n        );\n        const slippage = getMedian(slippage_txs);\n\n        const txsWithdraw = txs.filter(tx => tx < 0);\n        const wFees = -wFee * getSum(txsWithdraw);\n        //  txsWithdraw.reduce((t, c) => t + c, 0);\n\n        // Vest\n        const delta_H = vest_tokens({ week: t, H, halflife, cliff });\n        const H_next = H - delta_H;\n\n        // find floor price\n        const S_next = getS({ R, V0, k });\n        const floorprice_next = getMinPrice({\n          S: S_next,\n          H: S0 - H_next,\n          V0,\n          k\n        });\n\n        const _avgTxSize = getMedian(txsWithdraw);\n\n        R_t.push(R_next);\n        S_t.push(S_next);\n        H_t.push(H_next);\n        p_t.push(getPriceR({ R: R_next, V0, k }));\n        slippage_t.push(slippage);\n        avgTxSize_t.push(_avgTxSize);\n        wFee_t.push(getLast(wFee_t) + wFees);\n\n        floorprice_t.push(floorprice_next);\n        setWithdrawCount(c => c + txsWithdraw.length);\n\n        // Stop the simulation if it's no longer active\n        if (!simulationActive || !canContinueSimulation) break;\n      }\n\n      // floorprice_t is missing one data point\n      floorprice_t[floorprice_t.length] = floorprice_t[floorprice_t.length - 1];\n\n      setPriceTimeseries(p_t);\n      setWithdrawFeeTimeseries(wFee_t);\n      setFloorpriceTimeseries(floorprice_t);\n      setAvgSlippage(getAvg(slippage_t));\n      setAvgTxSize(getAvg(avgTxSize_t));\n      setTotalReserve(getLast(R_t));\n\n      setSimulationRunning(false);\n    }\n\n    if (simulationActive) simulateRandomDelta();\n    // Return an \"unsubscribe\" function that halts the run\n    return () => {\n      canContinueSimulation = false;\n    };\n  }, [simulationActive]);\n\n  const resultFields = [\n    {\n      label: `Total reserve`,\n      description: resultParameterDescriptions.totalReserve.text,\n      value: (+totalReserve.toPrecision(3)).toLocaleString() + \" DAI\"\n    },\n    {\n      label: `Funds generated from initial hatch`,\n      description: resultParameterDescriptions.initialHatchFunds.text,\n      value: Math.round(d0 * theta).toLocaleString() + \" DAI\"\n    },\n    {\n      label: `Funds generated from exit tributes (${withdrawCount} txs)`,\n      description: resultParameterDescriptions.exitTributes.text,\n      value:\n        (+getLast(withdrawFeeTimeseries).toPrecision(3)).toLocaleString() +\n        \" DAI\"\n    },\n    {\n      label: `Average slippage (avg tx size ${Math.round(\n        avgTxSize\n      ).toLocaleString()} DAI)`,\n      description: resultParameterDescriptions.slippage.text,\n      value: +(100 * avgSlippage).toFixed(3) + \"%\"\n    }\n  ];\n\n  const classes = useStyles();\n\n  return (\n    <>\n      <header className={classes.header}>\n        <Container fixed>\n          <Header />\n        </Container>\n      </header>\n\n      <Container fixed className={classes.mainContainer}>\n        <Grid container spacing={3}>\n          <Grid item xs={12} sm={12} md={6} lg={4}>\n            <Paper className={classes.paper}>\n              <Box className={classes.boxHeader}>\n                <Typography variant=\"h6\">Curve Design</Typography>\n                <HelpText\n                  text={\n                    <div className={classes.descriptionContainer}>\n                      <div>\n                        <Typography className={classes.descriptionTitle}>\n                          Parameters description:\n                        </Typography>\n                      </div>\n                      <table>\n                        <tbody>\n                          {[\n                            parameterDescriptions.theta,\n                            parameterDescriptions.p0,\n                            parameterDescriptions.p1,\n                            parameterDescriptions.wFee,\n                            parameterDescriptions.d0\n                          ].map(({ name, text }) => (\n                            <tr key={name}>\n                              <td>\n                                <Typography>{name}</Typography>\n                              </td>\n                              <td>\n                                <Typography className={classes.descriptionBody}>\n                                  {text}\n                                </Typography>\n                              </td>\n                            </tr>\n                          ))}\n                        </tbody>\n                      </table>\n                    </div>\n                  }\n                />\n              </Box>\n\n              <Box className={`${classes.box} ${classes.boxBorderBottom}`}>\n                <CurveDesignInputParams\n                  curveParams={curveParams}\n                  setCurveParams={setCurveParamsThrottle}\n                />\n              </Box>\n\n              <Box className={`${classes.boxHeader} ${classes.initialRaise}`}>\n                <Typography variant=\"h6\">Run parameters</Typography>\n              </Box>\n\n              <Box className={classes.box}>\n                <SimulationInputParams\n                  curveParams={curveParams}\n                  setCurveParams={setCurveParamsThrottle}\n                />\n              </Box>\n            </Paper>\n          </Grid>\n\n          <Grid item xs={12} sm={12} md={6} lg={8}>\n            <Paper className={classes.paper}>\n              <Box className={classes.boxHeader}>\n                <Typography variant=\"h6\">Preview</Typography>\n                <HelpText\n                  text={\n                    <div className={classes.descriptionPadding}>\n                      <Typography className={classes.descriptionBody}>\n                        Visualization of the token bonding curve analytic\n                        function on a specific range of reserve [0, 4 * R0].\n                        This result is deterministic given the current set of\n                        parameters and will never change regardes of the\n                        campaign performance, it only shows how the price will\n                        react to reserve changes.\n                      </Typography>\n                    </div>\n                  }\n                />\n              </Box>\n\n              <Box className={classes.boxChart}>\n                <SupplyVsDemandChart theta={theta} d0={d0} p0={p0} p1={p1} />\n              </Box>\n            </Paper>\n          </Grid>\n        </Grid>\n\n        <Grid container spacing={3}>\n          <Grid item xs={12} md={12}>\n            <Paper>\n              <Box className={classes.boxHeader}>\n                <Grid\n                  container\n                  direction=\"row\"\n                  justify=\"center\"\n                  alignItems=\"center\"\n                >\n                  <Button\n                    variant=\"contained\"\n                    className={classes.button}\n                    onClick={startSimulation}\n                    disabled={simulationRunning}\n                  >\n                    Run simulation\n                  </Button>\n                </Grid>\n              </Box>\n            </Paper>\n          </Grid>\n        </Grid>\n\n        <Grid container spacing={3} className={classes.simulationContainer}>\n          {simulationActive ? (\n            <>\n              <Grid item xs={12} sm={12} md={6} lg={8}>\n                <Paper className={classes.paper}>\n                  <Box className={classes.boxHeader}>\n                    <Typography variant=\"h6\">Simulation</Typography>\n                    <HelpText\n                      text={\n                        <div className={classes.descriptionContainer}>\n                          <div className={classes.descriptionPadding}>\n                            <Typography className={classes.descriptionBody}>\n                              This chart shows a 52 week simulation of discrete\n                              transactions interacting with the token bonding\n                              curve. Each transaction adds or substract reserve\n                              to the system, modifying the price over time. The\n                              frequency, size and direction of each transaction\n                              is computed from a set of bounded random\n                              functions.\n                            </Typography>\n                          </div>\n\n                          <table>\n                            <tbody>\n                              {Object.values(\n                                simulationParameterDescriptions\n                              ).map(({ name, text }) => (\n                                <tr key={name}>\n                                  <td>\n                                    <Typography>{name}</Typography>\n                                  </td>\n                                  <td>\n                                    <Typography\n                                      className={classes.descriptionBody}\n                                    >\n                                      {text}\n                                    </Typography>\n                                  </td>\n                                </tr>\n                              ))}\n                            </tbody>\n                          </table>\n                        </div>\n                      }\n                    />\n                  </Box>\n\n                  <Box className={classes.boxChart}>\n                    <PriceSimulationChart\n                      priceTimeseries={priceTimeseries}\n                      withdrawFeeTimeseries={withdrawFeeTimeseries}\n                      floorpriceTimeseries={floorpriceTimeseries}\n                      p0={p0}\n                      p1={p1}\n                    />\n                  </Box>\n                </Paper>\n              </Grid>\n\n              <Grid item xs={12} sm={12} md={6} lg={4}>\n                <Paper className={classes.paper}>\n                  <Box className={classes.boxHeader}>\n                    <Typography variant=\"h6\">Results</Typography>\n                    <HelpText\n                      text={\n                        <div className={classes.descriptionContainer}>\n                          <div>\n                            <Typography className={classes.descriptionTitle}>\n                              Result parameters description:\n                            </Typography>\n                          </div>\n                          <table>\n                            <tbody>\n                              {Object.values(resultParameterDescriptions).map(\n                                ({ name, text }) => (\n                                  <tr key={name}>\n                                    <td>\n                                      <Typography>{name}</Typography>\n                                    </td>\n                                    <td>\n                                      <Typography\n                                        className={classes.descriptionBody}\n                                      >\n                                        {text}\n                                      </Typography>\n                                    </td>\n                                  </tr>\n                                )\n                              )}\n                            </tbody>\n                          </table>\n                        </div>\n                      }\n                    />\n                  </Box>\n\n                  <Box className={classes.box}>\n                    <ResultParams resultFields={resultFields} />\n                  </Box>\n                </Paper>\n              </Grid>\n            </>\n          ) : (\n            <Grid item xs={12}>\n              <Paper className={classes.paper}>\n                <Box className={classes.boxPlaceholder}>\n                  <Typography variant=\"h6\">\n                    Run a simulation to see results\n                  </Typography>\n                </Box>\n              </Paper>\n            </Grid>\n          )}\n        </Grid>\n      </Container>\n    </>\n  );\n}\n","import red from \"@material-ui/core/colors/red\";\nimport { createMuiTheme } from \"@material-ui/core/styles\";\n\n// A custom theme for this app\nconst theme = createMuiTheme({\n  palette: {\n    type: \"dark\",\n    primary: {\n      main: \"#2ecd79\"\n    },\n    secondary: {\n      main: \"#116be0\",\n      light: \"#0f8bff\",\n      dark: \"#116be0\"\n    },\n    error: {\n      main: red.A400\n    },\n    background: {\n      default: \"#fff\",\n      paper: \"#293640\"\n    },\n    text: {\n      primary: \"#fff\",\n      secondary: \"#9aa3ad\"\n    }\n  },\n  typography: {\n    h6: {\n      fontWeight: 400\n    }\n  }\n});\n\nconsole.log(theme);\n\nexport default theme;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport { ThemeProvider } from '@material-ui/styles';\nimport App from './App';\nimport theme from './theme';\n\nReactDOM.render(\n  <ThemeProvider theme={theme}>\n    {/* CssBaseline kickstart an elegant, consistent, and simple baseline to build upon. */}\n    <CssBaseline />\n    <App />\n  </ThemeProvider>,\n  document.querySelector('#root'),\n);\n"],"sourceRoot":""}